(*
  AIM EXPRESS long form for ISO/IS 10303-224
*)

SCHEMA feature_based_process_planning;

  USE FROM action_schema                          -- ISO 10303-41
      (action_directive,
       action_method,
       action_relationship,
       action_request_solution, 
       action_request_status,
       action_status,
       directed_action,
       versioned_action_request);

  USE FROM application_context_schema             -- ISO 10303-41
      (application_context,
       application_protocol_definition); 

  USE FROM approval_schema                        -- ISO 10303-41
      (approval,
       approval_date_time,
       approval_person_organization,
       approval_relationship,
       approval_status);

  USE FROM date_time_schema                       -- ISO 10303-41
      (date,
       calendar_date,
       ordinal_date,
       week_of_year_and_day_date);

  USE FROM document_schema                        -- ISO 10303-41
      (document_with_class,
       document_usage_constraint,
       document_relationship);

  USE FROM external_reference_schema              -- ISO 10303-41
      (externally_defined_item);   

  USE FROM geometric_model_schema                 -- ISO 10303-42
      (brep_with_voids,
       manifold_solid_brep);

  USE FROM geometry_schema                        -- ISO 10303-42
      (axis2_placement_2d,
       axis2_placement_3d,
       bezier_curve,
       bezier_surface,
       b_spline_curve_with_knots,
       b_spline_surface_with_knots,
       cartesian_point,
       cartesian_transformation_operator_3d,
       circle,
       conical_surface,
       cylindrical_surface,
       degenerate_toroidal_surface,
       direction,
       ellipse,
       geometric_representation_context,
       hyperbola,
       line,
       parabola,
       pcurve,
       plane,
       point,
       polyline,
       quasi_uniform_curve,
       quasi_uniform_surface,
       rational_b_spline_curve,
       rational_b_spline_surface,
       spherical_surface,
       surface_curve,
       surface_of_linear_extrusion,
       surface_of_revolution,
       swept_surface,
       toroidal_surface,
       uniform_curve,
       uniform_surface,
       vector);

  USE FROM management_resources_schema            -- ISO 10303-41
      (action_assignment,
       action_request_assignment,
       approval_assignment,
       date_assignment,
       document_reference,
       organization_assignment,
       person_and_organization_assignment,
       security_classification_assignment);

  USE FROM material_property_representation_schema             -- ISO 10303-45
       (material_property_representation);

  USE FROM material_property_definition_schema    -- ISO 10303-45
      (material_designation,
       material_property,
       property_definition_relationship);
        
  USE FROM measure_schema                         -- ISO 10303-41
      (context_dependent_measure,
       context_dependent_unit,
       conversion_based_unit,
       count_measure, 
   derived_unit,
       descriptive_measure,
       global_unit_assigned_context,
       length_measure_with_unit,
       length_unit, 
       measure_with_unit,
       named_unit, 
       parameter_value,
       plane_angle_measure_with_unit,
       plane_angle_unit, 
       positive_plane_angle_measure, 
       ratio_measure_with_unit,
       ratio_unit,
       si_unit,
       solid_angle_measure_with_unit,
       solid_angle_unit);  

  USE FROM person_organization_schema             -- ISO 10303-41
      (organization_relationship,
       organizational_address,
       organizational_project,
       person_and_organization,
       personal_address);

  USE FROM product_definition_schema              -- ISO 10303-41
      (product,
       product_definition,
       product_definition_formation,
       product_definition_with_associated_documents);

  USE FROM product_property_definition_schema     -- ISO 10303-41
      (characterized_object,
       product_definition_shape, 
       property_definition,   
       shape_aspect,
       shape_aspect_relationship);

  USE FROM product_property_representation_schema -- ISO 10303-41
      (property_definition_representation,
       shape_definition_representation,
       shape_representation);

  USE FROM product_structure_schema               -- ISO 10303-44
      (make_from_usage_option);

  USE FROM qualified_measure_schema               -- ISO 10303-45
      (descriptive_representation_item,
       expanded_uncertainty,
       measure_representation_item,
       measure_qualification,
       precision_qualifier,
       qualified_representation_item,
       qualitative_uncertainty,
       standard_uncertainty,
       type_qualifier,
       uncertainty_qualifier);

  USE FROM representation_schema                  -- ISO 10303-43
      (definitional_representation,
       global_uncertainty_assigned_context,
       mapped_item,
       parametric_representation_context,
       representation,
       representation_item);

  USE FROM security_classification_schema         -- ISO 10303-41
      (security_classification,
       security_classification_level);

  USE FROM shape_aspect_definition_schema         -- ISO 10303-47
      (composite_shape_aspect,
       datum_feature,
       datum_reference,
       datum_target,
       referenced_modified_datum,
       datum);

  USE FROM shape_dimension_schema                 -- ISO 10303-47
      (angular_location,
       angular_size,
       dimensional_characteristic_representation,
       dimensional_location,
       dimensional_location_with_path,
       dimensional_size,
       dimensional_size_with_path,
       shape_dimension_representation);

  USE FROM shape_tolerance_schema                 -- ISO 10303-47
      (geometric_tolerance,
       geometric_tolerance_relationship,
       geometric_tolerance_with_datum_reference,
       geometric_tolerance_with_defined_unit,
       limits_and_fits,
       modified_geometric_tolerance,
       plus_minus_tolerance,
       projected_zone_definition,
       runout_zone_definition,
       runout_zone_orientation,
       tolerance_value,
       tolerance_zone,
       tolerance_zone_definition);  

  USE FROM support_resource_schema                -- ISO 10303-41
      (identifier,
       label,
       text);

  USE FROM topology_schema                        -- ISO 10303-42
      (closed_shell,
       connected_face_set,
       oriented_closed_shell,
       edge_curve,
       edge_loop,
       face_bound,
       face_outer_bound,
       face_surface,
       path,
       vertex_loop,
       vertex_point);

TYPE feature_based_pp_action_item = SELECT
  (product_definition_formation);
END_TYPE;

TYPE feature_based_pp_action_request_item = SELECT
  (product_definition_formation);
END_TYPE;

TYPE feature_based_pp_approved_item = SELECT
  (directed_action,
   product_definition_formation);
END_TYPE;

TYPE feature_based_pp_classified_item = SELECT
  (product_definition_formation);
END_TYPE;

TYPE feature_based_pp_dated_item = SELECT
  (directed_action,
   document_with_class,
   versioned_action_request);
END_TYPE;

TYPE feature_based_pp_document_item = SELECT
  (action_method,
   externally_defined_feature_definition,
   directed_action,
   dimensional_characteristic_representation,
   property_definition);
END_TYPE;

TYPE feature_based_pp_ordered_item = SELECT
  (product_definition_formation);
END_TYPE;

TYPE feature_based_pp_organization_item = SELECT
  (action_directive,
   product_definition_formation);
END_TYPE;

TYPE feature_based_pp_person_and_organization_item = SELECT
  (action_directive,
   product_definition_formation);
END_TYPE;

ENTITY advanced_brep_shape_representation
  SUBTYPE OF (shape_representation);
WHERE
  WR1: SIZEOF (QUERY (it <* SELF.items |
       NOT (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MANIFOLD_SOLID_BREP',
       'FEATURE_BASED_PROCESS_PLANNING.MAPPED_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.AXIS2_PLACEMENT_3D'] * 
       TYPEOF(it)) = 1))) = 0;
  WR2: SIZEOF (QUERY (it <* SELF.items | 
       SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MANIFOLD_SOLID_BREP',
       'FEATURE_BASED_PROCESS_PLANNING.MAPPED_ITEM'] * TYPEOF(it)) = 1)) >= 1;

  WR3: SIZEOF (QUERY (msb <* QUERY (it <* SELF.items |
       'FEATURE_BASED_PROCESS_PLANNING.MANIFOLD_SOLID_BREP' IN TYPEOF(it)) |
       NOT (SIZEOF (QUERY (csh <* msb_shells(msb) |
       NOT (SIZEOF (QUERY (fcs <* csh.cfs_faces | 
       NOT ('FEATURE_BASED_PROCESS_PLANNING.ADVANCED_FACE' IN 
       TYPEOF(fcs)))) = 0))) = 0))) = 0;
  WR4: SIZEOF (QUERY (msb <* QUERY (it <* items |
       'FEATURE_BASED_PROCESS_PLANNING.MANIFOLD_SOLID_BREP' IN TYPEOF(it)) |
       'FEATURE_BASED_PROCESS_PLANNING.ORIENTED_CLOSED_SHELL' IN 
       TYPEOF (msb.outer))) = 0;
  WR5: SIZEOF (QUERY (brv <* QUERY (it <* items |
       'FEATURE_BASED_PROCESS_PLANNING.BREP_WITH_VOIDS' IN TYPEOF(it)) | 
       NOT (SIZEOF (QUERY (csh <* brv.voids |
       csh.orientation))  = 0))) = 0;
  WR6: SIZEOF (QUERY (mi <* QUERY (it <* items |
       'FEATURE_BASED_PROCESS_PLANNING.MAPPED_ITEM' IN TYPEOF(it)) | 
       NOT ('FEATURE_BASED_PROCESS_PLANNING.' + 
       'ADVANCED_BREP_SHAPE_REPRESENTATION' IN
       TYPEOF (mi.mapping_source.mapped_representation)))) = 0;
END_ENTITY;


ENTITY advanced_face
  SUBTYPE OF (face_surface);
WHERE
  WR1 : SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.ELEMENTARY_SURFACE',
        'FEATURE_BASED_PROCESS_PLANNING.B_SPLINE_SURFACE',
        'FEATURE_BASED_PROCESS_PLANNING.SWEPT_SURFACE'] *
        TYPEOF (face_geometry)) = 1;
  WR2 : SIZEOF (QUERY (elp_fbnds <* QUERY (bnds <* SELF.bounds |
        'FEATURE_BASED_PROCESS_PLANNING.EDGE_LOOP' IN
        TYPEOF (bnds.bound)) |
        NOT (SIZEOF (QUERY (oe <* elp_fbnds.bound\path.edge_list |
        NOT('FEATURE_BASED_PROCESS_PLANNING.EDGE_CURVE' IN
        TYPEOF(oe.edge_element)))) = 0))) = 0;
  WR3 : SIZEOF (QUERY (elp_fbnds <* QUERY (bnds <* SELF.bounds |
        'FEATURE_BASED_PROCESS_PLANNING.EDGE_LOOP' IN
        TYPEOF (bnds.bound)) |
        NOT (SIZEOF (QUERY (oe <* elp_fbnds.bound\path.edge_list |
        NOT (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.LINE',
        'FEATURE_BASED_PROCESS_PLANNING.CONIC',
        'FEATURE_BASED_PROCESS_PLANNING.POLYLINE',
        'FEATURE_BASED_PROCESS_PLANNING.SURFACE_CURVE',
        'FEATURE_BASED_PROCESS_PLANNING.B_SPLINE_CURVE'] *
        TYPEOF (oe.edge_element\edge_curve.edge_geometry)) = 1))) = 0))) = 0;
  WR4 : SIZEOF (QUERY (elp_fbnds <* QUERY (bnds <* SELF.bounds |
        'FEATURE_BASED_PROCESS_PLANNING.EDGE_LOOP' IN
        TYPEOF (bnds.bound)) |
        NOT (SIZEOF (QUERY (oe <* elp_fbnds.bound\path.edge_list |
        NOT (((('FEATURE_BASED_PROCESS_PLANNING.VERTEX_POINT' IN
        TYPEOF (oe.edge_start)) AND
        ('FEATURE_BASED_PROCESS_PLANNING.CARTESIAN_POINT' IN
        TYPEOF (oe.edge_start\vertex_point.vertex_geometry)))) AND
        (('FEATURE_BASED_PROCESS_PLANNING.VERTEX_POINT' IN
        TYPEOF (oe.edge_end)) AND
        ('FEATURE_BASED_PROCESS_PLANNING.CARTESIAN_POINT' IN
        TYPEOF (oe.edge_end\vertex_point.vertex_geometry)))))) = 0))) = 0;
  WR5 : SIZEOF(QUERY (elp_fbnds <* QUERY (bnds <* SELF.bounds |
        'FEATURE_BASED_PROCESS_PLANNING.EDGE_LOOP' IN
         TYPEOF (bnds.bound)) |
         'FEATURE_BASED_PROCESS_PLANNING.ORIENTED_PATH' IN
         TYPEOF (elp_fbnds.bound))) = 0;
  WR6 : (NOT ('FEATURE_BASED_PROCESS_PLANNING.SWEPT_SURFACE' IN
        TYPEOF (face_geometry))) OR
        (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.LINE',
        'FEATURE_BASED_PROCESS_PLANNING.CONIC',
        'FEATURE_BASED_PROCESS_PLANNING.POLYLINE',
        'FEATURE_BASED_PROCESS_PLANNING.B_SPLINE_CURVE'] *
        TYPEOF (face_geometry\swept_surface.swept_curve)) = 1);
  WR7 : SIZEOF (QUERY (vlp_fbnds <* QUERY (bnds <* SELF.bounds |
        'FEATURE_BASED_PROCESS_PLANNING.VERTEX_LOOP' IN
        TYPEOF(bnds.bound)) |
        NOT (('FEATURE_BASED_PROCESS_PLANNING.VERTEX_POINT' IN
        TYPEOF (vlp_fbnds\face_bound.bound\vertex_loop.loop_vertex)) AND
        ('FEATURE_BASED_PROCESS_PLANNING.CARTESIAN_POINT' IN
        TYPEOF (vlp_fbnds\face_bound.bound\vertex_loop.
        loop_vertex\vertex_point.vertex_geometry))))) = 0;
  WR8 : SIZEOF (QUERY (bnd <* SELF.bounds |
        NOT (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.EDGE_LOOP',
        'FEATURE_BASED_PROCESS_PLANNING.VERTEX_LOOP'] *
        TYPEOF(bnd.bound)) = 1))) = 0;
  WR9 : SIZEOF (QUERY (elp_fbnds <* QUERY (bnds <* SELF.bounds |
        'FEATURE_BASED_PROCESS_PLANNING.EDGE_LOOP' IN
        TYPEOF (bnds.bound)) |
        NOT (SIZEOF (QUERY (oe <* elp_fbnds.bound\path.edge_list |
        ('FEATURE_BASED_PROCESS_PLANNING.SURFACE_CURVE' IN
        TYPEOF (oe.edge_element\edge_curve.edge_geometry)) AND 
        (NOT (SIZEOF (QUERY (sc_ag <* 
        oe.edge_element\edge_curve.edge_geometry\
        surface_curve.associated_geometry |
        NOT ('FEATURE_BASED_PROCESS_PLANNING.PCURVE' IN
        TYPEOF (sc_ag)))) = 0)))) = 0))) = 0;
  WR10 : ((NOT ('FEATURE_BASED_PROCESS_PLANNING.SWEPT_SURFACE' IN
         TYPEOF(face_geometry))) OR
         ((NOT ('FEATURE_BASED_PROCESS_PLANNING.POLYLINE' IN
         TYPEOF(face_geometry\swept_surface.swept_curve))) OR
         (SIZEOF(face_geometry\swept_surface.swept_curve\polyline.points)
         < 3))) AND
         (SIZEOF (QUERY (elp_fbnds <* QUERY (bnds <* SELF.bounds |
         'FEATURE_BASED_PROCESS_PLANNING.EDGE_LOOP' IN 
         TYPEOF (bnds.bound)) |
         NOT (SIZEOF (QUERY (oe <* elp_fbnds.bound\path.edge_list |
         ('FEATURE_BASED_PROCESS_PLANNING.POLYLINE' IN
         TYPEOF(oe.edge_element\edge_curve.edge_geometry)) AND 
         (NOT (SIZEOF (oe.edge_element\edge_curve.edge_geometry\
         polyline.points) < 3)))) = 0))) = 0);
 END_ENTITY;

ENTITY angularity_tolerance
  SUBTYPE OF (geometric_tolerance_with_datum_reference);
WHERE
  WR1: SELF\geometric_tolerance.name = 'angularity';
  WR2: SIZEOF (SELF\geometric_tolerance_with_datum_reference.datum_system) 
       = 1;
END_ENTITY;

ENTITY applied_area
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN 
       TYPEOF (SELF.of_shape.definition); 
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 2))) = 0))) = 0;
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (
       ['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'length'))) = 1))) = 0))) = 0;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN 
       TYPEOF (it)) AND (it.name = 'orientation'))) = 1))) = 0))) = 0;
END_ENTITY;

ENTITY block_shape_representation
  SUBTYPE OF (shape_representation_with_parameters);
WHERE
  WR1: SIZEOF (SELF.items) = 4;
  WR2: SIZEOF (QUERY (it <* SELF.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND 
       (it.name = 'orientation'))) = 1;  
  WR3: SIZEOF (QUERY (it <* SELF.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND
       (it.name = 'length'))) = 1; 
  WR4: SIZEOF (QUERY (it <* SELF.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND
       (it.name = 'width'))) = 1; 
  WR5: SIZEOF (QUERY (it <* SELF.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND
       (it.name = 'height'))) = 1; 
END_ENTITY;

ENTITY boss
  SUBTYPE OF (feature_definition);
WHERE   
  WR1: SELF.description IN ['circular', 'non-circular'];
  WR2: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) |
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'boss height occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'path feature component usage') AND 
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.PATH_FEATURE_COMPONENT' IN
       TYPEOF (sdr.relating_shape_aspect)) AND
       (sdr.relating_shape_aspect.description = 'linear') AND
       (sdr.name = 'boss height'))) = 1))) = 1))) = 0; 
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <*  
       impl_rep.used_representation.items |
       (SIZEOF (
       ['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'fillet radius'))) = 1))) = 0))) = 0;
  WR4: (NOT (SELF.description = 'circular')) OR
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) |
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'circular profile occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND 
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       'FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_CLOSED_PROFILE' IN
       TYPEOF (sdr.relating_shape_aspect))) = 1))) = 1))) = 0);
  WR5: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'top condition occurrence') AND
       (SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (sa_occ, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'boss top usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'FEATURE_COMPONENT_RELATIONSHIP' IN TYPEOF (sar))) |
       'FEATURE_BASED_PROCESS_PLANNING.BOSS_TOP' IN  
       TYPEOF (fcr.relating_shape_aspect))) = 1))) = 1))) = 0;
  WR6: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'change in diameter occurrence') AND
       (SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (sa_occ, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'taper usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'FEATURE_COMPONENT_RELATIONSHIP' IN TYPEOF (sar))) |
       'FEATURE_BASED_PROCESS_PLANNING.TAPER' IN  
       TYPEOF (fcr.relating_shape_aspect))) = 1))) <= 1))) = 0;
  WR7: (NOT (SELF.description = 'non-circular')) OR
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'enclosed boundary occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.NGON_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.CLOSED_PATH_PROFILE'] *  
       TYPEOF (sdr.relating_shape_aspect)) = 1)) = 1)))= 1))) = 0);
  WR8: (NOT (SELF.description = 'non-circular')) OR
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'change in boundary occurrence') AND
       (SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (sa_occ, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') |
       (sar.description = 'taper usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'FEATURE_COMPONENT_RELATIONSHIP' IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.TAPER' IN  
       TYPEOF (fcr.related_shape_aspect)) AND
       (fcr.related_shape_aspect.description = 'angle taper'))) 
       = 1))) = 1))) = 0);
END_ENTITY;

ENTITY boss_top
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN 
       TYPEOF (SELF.of_shape.definition); 
  WR2: SELF.description IN ['planar', 'non-planar'];
  WR3: (NOT (SELF.description = 'planar')) OR 
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'DIRECTION_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0); 
  WR4: (NOT (SELF.description = 'planar')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'LOCATION_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0);
  WR5: (NOT (SELF.description = 'non-planar')) OR 
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'FACE_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0);
  WR6: SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') | 
       (sar.description = 'boss top usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' IN
       TYPEOF (sar))) |
       (fcr.related_shape_aspect.description = 'top condition occurrence') 
       AND ('FEATURE_BASED_PROCESS_PLANNING.BOSS' IN TYPEOF
       (fcr.related_shape_aspect.of_shape.definition)))) >= 1;
  WR7: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR8: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 1))) = 0))) = 0; 
  WR9: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM'
       IN TYPEOF(it)) AND (it.name = 'boss top orientation') AND
       (it.description IN ['boss start', 'boss end']))) = 1))) = 0))) = 0;
END_ENTITY;

ENTITY chamfer
  SUBTYPE OF (transition_feature);
WHERE
  WR1: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation)) AND
       (pdr.used_representation.name = 'chamfer face'))) <= 1))) = 0;
  WR2: SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') |
       'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' IN
       TYPEOF (sar)) |
       ('FEATURE_BASED_PROCESS_PLANNING.CHAMFER_OFFSET' IN 
       TYPEOF (fcr.related_shape_aspect)) AND
       (fcr.related_shape_aspect.description = 'first offset'))) = 1;
  WR3: SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') |
       'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' IN
       TYPEOF (sar)) |
       ('FEATURE_BASED_PROCESS_PLANNING.CHAMFER_OFFSET' IN 
       TYPEOF (fcr.related_shape_aspect)) AND
       (fcr.related_shape_aspect.description = 'second offset'))) = 1;
END_ENTITY;

ENTITY chamfer_offset
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: SELF.description IN ['first offset', 'second offset'];
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 1))) = 0))) = 0;
  WR4: (NOT (SELF.description = 'first offset')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'offset amount'))) = 1))) = 0))) = 0);
  WR5: (NOT (SELF.description = 'first offset')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation)) AND
       (pdr.used_representation.name = 'first face shape'))) = 1))) = 0);
  WR6: (NOT (SELF.description = 'second offset')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ((SIZEOF 
       (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'offset amount')) OR
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'offset angle'))) = 1))) = 0))) = 0);
  WR7: (NOT (SELF.description = 'second offset')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation)) AND
       (pdr.used_representation.name = 'second face shape'))) = 1))) = 0);
  WR8: SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'FEATURE_COMPONENT_RELATIONSHIP' IN TYPEOF (sar)) |
       'FEATURE_BASED_PROCESS_PLANNING.CHAMFER' IN 
       TYPEOF (sdr.relating_shape_aspect))) >= 1;

END_ENTITY;

ENTITY circular_closed_profile
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN  
       TYPEOF (SELF.of_shape.definition);
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') | 
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |      
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 2))) = 0))) = 0; 
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND 
       (it.name = 'orientation'))) = 1)) = 0))) = 0; 
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'diameter'))) = 1))) = 0))) = 0;
END_ENTITY;

ENTITY circular_pattern
   SUBTYPE OF (replicate_feature);
WHERE
  WR1: SIZEOF (USEDIN (SELF,'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT')) <= 3; 
  WR2: SIZEOF (QUERY (sar <* USEDIN (SELF,'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT') |
       NOT ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' IN
       TYPEOF (sar)))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) | 
       NOT (SIZEOF (impl_rep.used_representation.items) = 5))) = 0))) = 0;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |      
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'diameter'))) = 1))) = 0))) = 0;
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'base feature rotation'))) = 1))) 
       = 0))) = 0;
  WR7: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND 
       ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' IN 
       TYPEOF (it\measure_with_unit.value_component)) AND 
       (it.name = 'number of features'))) = 1))) = 0))) = 0;
  WR8: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'angular spacing'))) = 1))) = 0)))
       = 0;
  WR9: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN 
       TYPEOF (it)) AND (it.name = 'orientation'))) = 1))) = 0))) = 0;
END_ENTITY;

ENTITY circular_runout_tolerance
  SUBTYPE OF (geometric_tolerance_with_datum_reference);
WHERE
  WR1: SELF\geometric_tolerance.name = 'circular runout';
  WR2: SIZEOF (SELF\geometric_tolerance_with_datum_reference.datum_system) 
       <= 2;
END_ENTITY;

ENTITY closed_path_profile
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN 
       TYPEOF (SELF.of_shape.definition);
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') | 
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 1))) = 0))) = 0; 
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND 
       (it.name = 'orientation'))) = 1))) = 0))) = 0;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PATH_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
END_ENTITY;

ENTITY composite_hole
  SUBTYPE OF (composite_machining_feature);
WHERE
  WR1: SELF.description IN ['counterbore', 'countersunk'];
  WR2: SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' + 
       'RELATING_SHAPE_ASPECT') |
       'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' IN 
       TYPEOF (sar)) |
       'FEATURE_BASED_PROCESS_PLANNING.ROUND_HOLE' IN TYPEOF 
       (fcr.related_shape_aspect))) = 2;
  WR3: SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' + 
       'RELATING_SHAPE_ASPECT') |
       'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' IN 
       TYPEOF (sar)) |
       (NOT ('FEATURE_BASED_PROCESS_PLANNING.ROUND_HOLE' IN TYPEOF 
       (fcr.related_shape_aspect))) OR
       (SIZEOF (QUERY (fcr2 <* QUERY (sar2 <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' + 
       'RELATING_SHAPE_ASPECT') - fcr | 
       'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' IN 
       TYPEOF (sar2)) |
       (NOT ('FEATURE_BASED_PROCESS_PLANNING.ROUND_HOLE' IN TYPEOF 
       (fcr2.related_shape_aspect))) OR
       (SIZEOF (QUERY (pd <* USEDIN (fcr.related_shape_aspect, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       (NOT (
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) OR 
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (it.name = 'diameter') AND
       (SIZEOF (QUERY (pd2 <* USEDIN (fcr2.related_shape_aspect, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr2 <* USEDIN (pd2,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       (NOT (
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr2.used_representation))) OR 
       (SIZEOF (QUERY (pd2 <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep2 <* QUERY (pdr2 <* USEDIN (pd2,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr2.used_representation)) |
       NOT (SIZEOF (QUERY (it2 <* impl_rep2.used_representation.items |
       (it2.name = 'diameter') AND
       (it\measure_with_unit.value_component = 
       it2\measure_with_unit.value_component))) = 0))) = 0))) = 0))) = 0))) 
       = 0))) = 0))) = 0))) = 0))) = 0))) = 0))) = 0))) = 0;
  WR4: (NOT (SELF.description = 'countersunk')) OR
       (SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') |
       'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' IN 
       TYPEOF (sar)) |
       ('FEATURE_BASED_PROCESS_PLANNING.ROUND_HOLE' IN TYPEOF 
       (fcr.related_shape_aspect)) AND
       (SIZEOF (QUERY (rh_sdr <* QUERY (rh_sar <* 
       USEDIN (fcr.related_shape_aspect, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') |
       'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' IN 
       TYPEOF (rh_sar)) |
       'FEATURE_BASED_PROCESS_PLANNING.TAPER' IN  
       TYPEOF (rh_sdr.related_shape_aspect))) = 1))) = 1);
END_ENTITY;

ENTITY composite_machining_feature
  SUBTYPE OF (machining_feature);
WHERE 
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.COMPOSITE_SHAPE_ASPECT' IN
       TYPEOF (SELF);
  WR2: SIZEOF (QUERY (sar <* SELF\composite_shape_aspect.
       component_relationships | 
       NOT ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP'
       IN TYPEOF (sar)))) = 0;
  WR3: SIZEOF (QUERY (sar <* SELF\composite_shape_aspect.
       component_relationships | 
       NOT ('FEATURE_BASED_PROCESS_PLANNING.MACHINING_FEATURE' IN 
       TYPEOF (sar.related_shape_aspect)))) = 0;
END_ENTITY;

ENTITY concentricity_tolerance
  SUBTYPE OF (geometric_tolerance_with_datum_reference);
WHERE
  WR1: SELF\geometric_tolerance.name = 'concentricity';
  WR2: SIZEOF (SELF\geometric_tolerance_with_datum_reference.datum_system) =
       1;
END_ENTITY;

ENTITY cylindrical_shape_representation
  SUBTYPE OF (shape_representation_with_parameters);
WHERE
  WR1: SIZEOF (SELF.items) = 3;
  WR2: SIZEOF (QUERY (it <* SELF.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND  
       (it.name = 'orientation'))) = 1;
  WR3: SIZEOF (QUERY (it <* SELF.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND
       (it.name = 'length'))) = 1; 
  WR4: SIZEOF (QUERY (it <* SELF.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND
       (it.name = 'diameter'))) = 1; 
END_ENTITY;

ENTITY directed_dimensional_location
  SUBTYPE OF (dimensional_location);
END_ENTITY;

ENTITY direction_shape_representation
  SUBTYPE OF (representation);
WHERE
  WR1: SIZEOF (SELF.items) = 1;
  WR2: SIZEOF (QUERY (it <* SELF.items |
       NOT ('FEATURE_BASED_PROCESS_PLANNING.DIRECTION' IN TYPEOF 
       (it)))) = 0;
END_ENTITY; 

ENTITY edge_round
  SUBTYPE OF (transition_feature);
WHERE
  WR1: (NOT (SELF\shape_aspect.description = 'constant radius')) XOR
       (NOT (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <*  USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS' 
       IN TYPEOF (pdr.used_representation))) = 1))) = 0));
  WR2: (NOT (SELF\shape_aspect.description = 'constant radius')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 3))) = 0))) = 0); 
  WR3: (NOT (SELF.description = 'constant radius')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'radius'))) = 1))) = 0))) = 0);
  WR4: (NOT (SELF.description = 'constant radius')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'first offset'))) = 1))) = 0))) = 0);
  WR5: (NOT (SELF.description = 'constant radius')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'second offset'))) = 1))) = 0))) = 0);
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation)) AND 
       (pdr.used_representation.name = 'edge round face'))) <= 1))) = 0; 
  WR7: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation)) AND 
       (pdr.used_representation.name = 'first face shape'))) = 1))) = 0;
  WR8: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation)) AND 
       (pdr.used_representation.name = 'second face shape'))) = 1))) = 0;
END_ENTITY;

ENTITY externally_defined_feature_definition
  SUBTYPE OF (feature_definition, externally_defined_item);
WHERE
  WR1: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT ({1 <= SIZEOF (impl_rep.items) <= 8}))) = 0)))  = 0; 
  WR2: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'partial area occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'applied area usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       'FEATURE_BASED_PROCESS_PLANNING.APPLIED_AREA' IN  
       TYPEOF (sdr.relating_shape_aspect))) = 1))) <= 1))) = 0;
  WR3: SIZEOF (USEDIN (SELF, 'FEATURE_BASED_PROCESS_PLANNING.' +   
       'FEATURE_BASED_PP_DOCUMENT_REFERENCE.ITEMS')) = 1;
  WR4: (NOT (SELF.description = 'marking')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND (it.name = 'marking text'))) = 1))) = 0))) = 0); 
  WR5: (NOT (SELF.description = 'thread')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND (it.name = 'thread system') AND
       ((it.description = 'english') OR
       (it.description = 'metric')))) = 1))) = 0))) = 0);
  WR6: (NOT (SELF.description = 'thread')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND (it.name = 'removal direction') AND
       ((it.description = 'internal') OR
       (it.description = 'external')))) = 1))) = 0))) = 0);
WR7: (NOT (SELF.description = 'thread')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND (it.name = 'qualifier'))) = 1))) = 0))) = 0);
WR8: (NOT (SELF.description = 'thread')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND (it.name = 'hand'))) <= 1))) = 0))) = 0);
WR9: (NOT (SELF.description = 'thread')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND (it.name = 'fit class'))) <= 1))) = 0))) = 0);
WR10: (NOT (SELF.description = 'thread')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND (it.name = 'form'))) <= 1))) = 0))) = 0);
WR11: (NOT (SELF.description = 'thread')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF(['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT']*
       TYPEOF (it))=2) AND (it.name = 'major diameter'))) <= 1))) = 0))) = 0);
WR12: (NOT (SELF.description = 'thread')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF(['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.RATIO_MEASURE_WITH_UNIT'] *
       TYPEOF (it))=2) AND (it.name = 'number of threads')))<= 1)))= 0)))= 0);
END_ENTITY;

ENTITY face_shape_representation
  SUBTYPE OF (representation);
WHERE
  WR1: SIZEOF (SELF.items) = 1;
  WR2: SIZEOF (QUERY (it <* SELF.items |
       NOT ('FEATURE_BASED_PROCESS_PLANNING.FACE_SURFACE' IN TYPEOF        
       (it)))) = 0;
END_ENTITY;

ENTITY feature_based_pp_action_assignment
  SUBTYPE OF (action_assignment);
  items : SET [1:?] OF feature_based_pp_action_item;
END_ENTITY;

ENTITY feature_based_pp_action_request_assignment
  SUBTYPE OF (action_request_assignment);
  items : SET [1:?] OF feature_based_pp_action_request_item;
END_ENTITY;

ENTITY feature_based_pp_approval_assignment
  SUBTYPE OF (approval_assignment);
  items : SET [1:?] OF feature_based_pp_approved_item;
END_ENTITY;

ENTITY feature_based_pp_date_assignment
  SUBTYPE OF (date_assignment);
  items : SET [1:?] OF feature_based_pp_dated_item;
END_ENTITY;

ENTITY feature_based_pp_document_reference
  SUBTYPE OF (document_reference);
  items : SET [1:?] OF feature_based_pp_document_item;
END_ENTITY;

ENTITY feature_based_pp_organization_assignment
  SUBTYPE OF (organization_assignment);
  items : SET [1:?] OF feature_based_pp_organization_item;
END_ENTITY;

ENTITY feature_based_pp_person_and_organization_assignment
  SUBTYPE OF (person_and_organization_assignment);
  items : SET [1:?] OF feature_based_pp_person_and_organization_item;
END_ENTITY;

ENTITY feature_based_pp_security_classification_assignment
  SUBTYPE OF (security_classification_assignment);
  items : SET [1:?] OF feature_based_pp_classified_item;
END_ENTITY;

ENTITY feature_component_definition
  SUBTYPE OF (characterized_object);
WHERE
  WR1: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE')) = 1))) = 0;
END_ENTITY;

ENTITY feature_component_relationship
  SUPERTYPE OF (ONEOF (pattern_omit_membership, pattern_offset_membership))
  SUBTYPE OF (shape_aspect_relationship);
WHERE
 WR1: (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.REPLICATE_FEATURE',
      'FEATURE_BASED_PROCESS_PLANNING.COMPOSITE_MACHINING_FEATURE',
      'FEATURE_BASED_PROCESS_PLANNING.TRANSITION_FEATURE'] *
      TYPEOF (SELF.relating_shape_aspect)) = 1)
      OR ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_DEFINITION' IN
      TYPEOF (SELF.relating_shape_aspect.of_shape))OR(
      'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN 
      TYPEOF(SELF.relating_shape_aspect.of_shape));
END_ENTITY;

ENTITY feature_definition
  SUBTYPE OF (characterized_object);
WHERE
  WR1: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') | NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       'FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN 
       TYPEOF (it))) = 1))) = 0))) = 0;
END_ENTITY;

ENTITY feature_pattern
  SUBTYPE OF (replicate_feature);  
WHERE
  WR1: SIZEOF (QUERY (sar <* USEDIN (SELF,'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT') |
       (('FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP' IN
       TYPEOF (sar)) AND (sar.name = 'replicate positioning')) AND 
       (NOT (SIZEOF (QUERY (pd <* USEDIN (sar.related_shape_aspect, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN 
       TYPEOF (it)) AND (it.name = 'base feature placement'))) >= 1))) = 0)))
       = 0)))) = 1;
END_ENTITY;

ENTITY fillet
  SUBTYPE OF (transition_feature);
WHERE
  WR1: (NOT (SELF\shape_aspect.description = 'constant radius')) XOR
       (NOT (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <*  USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS' 
       IN TYPEOF (pdr.used_representation))) = 1))) = 0));
  WR2: (NOT (SELF\shape_aspect.description = 'constant radius')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 3))) = 0))) = 0); 
  WR3: (NOT (SELF.description = 'constant radius')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'radius'))) = 1))) = 0))) = 0);
  WR4: (NOT (SELF.description = 'constant radius')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'first offset'))) = 1))) = 0))) = 0);
  WR5: (NOT (SELF.description = 'constant radius')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'second offset'))) = 1))) = 0))) = 0);
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation)) AND 
       (pdr.used_representation.name = 'fillet face'))) <= 1))) = 0; 
  WR7: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation)) AND 
       (pdr.used_representation.name = 'first face shape'))) = 1))) = 0; 
  WR8: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation)) AND 
       (pdr.used_representation.name = 'second face shape'))) = 1))) = 0;  
  WR9: SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') |
       'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' IN 
       TYPEOF (sar)) |
       'FEATURE_BASED_PROCESS_PLANNING.TAPER' IN  
       TYPEOF (fcr.related_shape_aspect))) <= 1; 
END_ENTITY;

ENTITY flat_face
  SUBTYPE OF (feature_definition);
WHERE
  WR1: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.DIRECTION_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))  AND
       (pdr.used_representation.name = 'removal direction'))) 
       = 1))) = 0; 
  WR2: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'course of travel occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'path feature component usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.PATH_FEATURE_COMPONENT' IN
       TYPEOF (sdr.relating_shape_aspect)) AND
       (sdr.relating_shape_aspect.description = 'linear') AND
       (sdr.name = 'course of travel'))) = 1))) = 1))) = 0; 
  WR3: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'removal boundary occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.LINEAR_PROFILE' IN
       TYPEOF (sdr.relating_shape_aspect)) AND
       (sdr.name = 'removal boundary'))) = 1))) = 1))) = 0; 
END_ENTITY;

ENTITY hole_bottom
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN
       TYPEOF (SELF.of_shape.definition);
  WR2: SELF.description IN ['through', 'flat', 'flat with radius',
       'spherical', 'conical'];
  WR3: (NOT (SELF.description = 'through')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (USEDIN (pd, 'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION')) = 0))) = 0); 
  WR4: (NOT (SELF.description IN ['flat', 'flat with radius', 'spherical', 
       'conical'])) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0);
  WR5: (NOT (SELF.description = 'flat')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 1))) = 0))) = 0);
  WR6: (NOT (SELF.description IN ['flat with radius', 'spherical'])) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 2))) = 0))) = 0);
  WR7: (NOT (SELF.description = 'conical')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 3))) = 0))) = 0);
  WR8: (NOT (SELF.description IN ['flat', 'flat with radius', 'spherical', 
       'conical'])) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND (it.name = 'blind bottom orientation') AND
       (it.description IN ['hole start', 'hole end']))) = 1)) = 0))) = 0); 
  WR9: (NOT (SELF.description = 'flat with radius')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation) ) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF (it)) = 2) AND (it.name = 'corner radius'))) = 1))) = 0))) = 0);
 WR10: (NOT (SELF.description = 'spherical')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT ( SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation) ) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF (it)) = 2) AND (it.name = 'radius'))) = 1))) = 0))) = 0);
 WR11: (NOT (SELF.description = 'conical')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT ( SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
        IN TYPEOF (pdr.used_representation) ) |
        NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
        (SIZEOF 
        (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
        TYPEOF (it)) = 2)  AND (it.name = 'tip radius'))) = 1))) = 0))) = 0);
  WR12: (NOT (SELF.description = 'conical')) OR
        (SIZEOF (QUERY (pd <* USEDIN (SELF, 
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
        NOT ( SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
        'FEATURE_BASED_PROCESS_PLANNING.' + 
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
        'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
        IN TYPEOF (pdr.used_representation) ) |
        NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
        (SIZEOF 
        (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
        'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *
        TYPEOF (it)) = 2)  AND (it.name = 'tip angle'))) = 1))) = 0))) = 0);
  WR13: SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (SELF,
        'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
        'RELATING_SHAPE_ASPECT') |
        (sar.description = 'hole bottom usage') AND 
        ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' IN
        TYPEOF (sar))) |
        (fcr.related_shape_aspect.description = 'bottom condition occurrence')
        AND
        ('FEATURE_BASED_PROCESS_PLANNING.ROUND_HOLE' IN TYPEOF
        (fcr.related_shape_aspect.of_shape.definition)))) >= 1;
END_ENTITY;

ENTITY instanced_feature
  SUBTYPE OF (feature_definition, shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION' IN 
       TYPEOF (SELF.of_shape.definition);
  WR2: SELF.product_definitional;
END_ENTITY;

ENTITY linear_profile
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN
       TYPEOF (SELF.of_shape.definition);
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 2))) = 0))) = 0;  
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND 
       (it.name = 'orientation'))) = 1))) = 0))) = 0;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'profile length'))) = 1))) = 0))) = 0;
END_ENTITY;

ENTITY linear_profile_tolerance
  SUBTYPE OF (geometric_tolerance);
WHERE
  WR1: SELF\geometric_tolerance.name = 'linear profile';
  WR2: (NOT ('FEATURE_BASED_PROCESS_PLANNING.' + 
       'GEOMETRIC_TOLERANCE_WITH_DATUM_REFERENCE' IN TYPEOF (SELF))) OR
(SIZEOF
       (SELF\geometric_tolerance_with_datum_reference.datum_system) <= 3);
END_ENTITY;

ENTITY location_shape_representation
  SUBTYPE OF (representation);
WHERE
  WR1: SIZEOF (SELF.items) = 1;
  WR2: SIZEOF (QUERY (it <* SELF.items |
       NOT ('FEATURE_BASED_PROCESS_PLANNING.POINT' IN 
       TYPEOF(it)))) = 0;
END_ENTITY;

ENTITY machining_feature
  SUBTYPE OF (instanced_feature);
WHERE
  WR1: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION')) >= 1))) = 0;
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.BOSS', 
       'FEATURE_BASED_PROCESS_PLANNING.TURNED_KNURL', 
       'FEATURE_BASED_PROCESS_PLANNING.THREAD', 
       'FEATURE_BASED_PROCESS_PLANNING.MARKING',           
       'FEATURE_BASED_PROCESS_PLANNING.ROUND_HOLE',
       'FEATURE_BASED_PROCESS_PLANNING.OUTSIDE_PROFILE', 
       'FEATURE_BASED_PROCESS_PLANNING.POCKET', 
       'FEATURE_BASED_PROCESS_PLANNING.REMOVAL_VOLUME', 
       'FEATURE_BASED_PROCESS_PLANNING.REVOLVED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.OUTER_ROUND', 
       'FEATURE_BASED_PROCESS_PLANNING.FLAT_FACE', 
       'FEATURE_BASED_PROCESS_PLANNING.PROTRUSION', 
       'FEATURE_BASED_PROCESS_PLANNING.ROUNDED_END', 
       'FEATURE_BASED_PROCESS_PLANNING.SLOT', 
       'FEATURE_BASED_PROCESS_PLANNING.SPHERICAL_CAP',
       'FEATURE_BASED_PROCESS_PLANNING.STEP', 
       'FEATURE_BASED_PROCESS_PLANNING.COMPOSITE_MACHINING_FEATURE',
       'FEATURE_BASED_PROCESS_PLANNING.EXTERNALLY_DEFINED_FEATURE_DEFINITION']
       * TYPEOF (SELF)) = 1;
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN
       TYPEOF (it)) AND (it.name = 'orientation'))) = 1))) = 0))) = 0;
  WR5: (NOT (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.TURNED_KNURL', 
       'FEATURE_BASED_PROCESS_PLANNING.THREAD', 
       'FEATURE_BASED_PROCESS_PLANNING.MARKING',           
       'FEATURE_BASED_PROCESS_PLANNING.EXTERNALLY_DEFINED_FEATURE_DEFINITION']
       * TYPEOF (SELF)) = 1)) OR
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP' IN 
       TYPEOF (sar)) |
       sdr.name = 'applied shape')) = 1);
  WR6: number_of_representation_items (SELF);
END_ENTITY;

ENTITY marking
  SUBTYPE OF (feature_definition);
WHERE
  WR1: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND (it.name = 'marking text'))) = 1))) = 0))) = 0;
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND (it.name = 'special instructions'))) <= 1))) = 0))) 
       = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND (it.name = 'font name'))) <= 1))) = 0))) = 0;
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'character height'))) <= 1))) = 0))) 
       = 0;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'character spacing'))) <= 1))) = 0))) 
       = 0;
END_ENTITY;

ENTITY modified_pattern
  SUBTYPE OF (replicate_feature);
WHERE
  WR1: SIZEOF (QUERY (sar <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN',
       'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN'] * 
       TYPEOF (sar.related_shape_aspect)) = 1) AND
       (sar.related_shape_aspect.description = 'base pattern'))) = 1;
  WR2: SIZEOF (QUERY (sar <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') |
       NOT (SIZEOF (QUERY (msar <* USEDIN (sar.related_shape_aspect,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' + 
       'RELATED_SHAPE_ASPECT') |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.PATTERN_OFFSET_MEMBERSHIP',
       'FEATURE_BASED_PROCESS_PLANNING.PATTERN_OMIT_MEMBERSHIP'] * 
       TYPEOF (sar)) = 1) AND (sar :<>: msar))) >= 1))) = 0;
END_ENTITY;

ENTITY ngon_closed_profile
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN
       TYPEOF (SELF.of_shape.definition);
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') | 
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
      'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 4))) = 0))) = 0; 
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND 
       (it.name = 'orientation'))) = 1))) = 0))) = 0;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND 
       ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' IN 
       TYPEOF (it\measure_with_unit.value_component)) AND 
       (it.name = 'number of sides'))) = 1))) = 0))) = 0;
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'circumscribed diameter'))) = 1))) = 0))) = 0;
  WR7: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'corner radius'))) = 1))) = 0))) = 0;
END_ENTITY;

ENTITY ngon_shape_representation
  SUBTYPE OF (shape_representation_with_parameters);
WHERE
  WR1: SIZEOF (SELF.items) = 5;
  WR2: SIZEOF (QUERY (it <* SELF.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND 
       (it.name = 'orientation'))) = 1; 
  WR3: SIZEOF (QUERY (it <* SELF.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND
       (it.name = 'length'))) = 1; 
  WR4: SIZEOF (QUERY (it <* SELF.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND
       (it.name = 'corner radius'))) = 1; 
  WR5: SIZEOF (QUERY (it <* SELF.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND
       (it.name = 'circumscribed diameter'))) = 1; 
  WR6: SIZEOF (QUERY (it <* SELF.items |
       ('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' IN
       TYPEOF (it\measure_with_unit.value_component)) AND 
       (it.name = 'number of sides'))) = 1; 
END_ENTITY;

ENTITY open_path_profile
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN
       TYPEOF (SELF.of_shape.definition);
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 1))) = 0))) = 0;  
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND 
       (it.name = 'orientation'))) = 1))) = 0))) = 0;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PATH_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
END_ENTITY;

ENTITY ordered_part
  SUBTYPE OF (action_assignment, characterized_object);
  items : SET [1:?] OF feature_based_pp_ordered_item;  
WHERE
  WR1: SIZEOF (USEDIN (SELF, 'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION.DEFINITION')) = 1;
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') | 
       NOT (SIZEOF (USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION')) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       NOT (SIZEOF (items) = 1))) = 0))) = 0;
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       NOT (SIZEOF (QUERY (it <* pdr.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' IN 
       TYPEOF (it)) AND (it.name = 'quantity'))) = 1))) = 0))) = 0;
END_ENTITY;

ENTITY outer_round
  SUBTYPE OF (feature_definition);
WHERE
  WR1: SELF.description IN ['outer diameter', 'outer diameter to shoulder']; 
  WR2: (NOT (SELF.description = 'outer diameter')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'length'))) = 1))) = 0))) = 0);
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'diameter'))) = 1))) = 0))) = 0;
  WR4: (NOT (SELF.description = 'outer diameter to shoulder')) OR
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'v-shape boundary occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.VEE_PROFILE' IN
       TYPEOF (sdr.relating_shape_aspect)) AND
       (sdr.relating_shape_aspect.description = 'v-shape'))) 
       = 1))) = 1))) = 0);
  WR5: (NOT (SELF.description = 'outer diameter')) OR 
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'reduced size occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'taper usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'FEATURE_COMPONENT_RELATIONSHIP' IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.TAPER' IN
       TYPEOF (sdr.relating_shape_aspect)) AND
       (sdr.name = 'reduced size'))) = 1))) <= 1))) = 0);
END_ENTITY;

ENTITY outside_profile
  SUBTYPE OF (feature_definition);
WHERE
  WR1: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'boundary occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_CLOSED_PROFILE', 
       'FEATURE_BASED_PROCESS_PLANNING.NGON_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.CLOSED_PATH_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.SQUARE_U_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.PARTIAL_CIRCULAR_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.ROUNDED_U_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.LINEAR_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.VEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.TEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.OPEN_PATH_PROFILE'] *
       TYPEOF (sdr.relating_shape_aspect)) = 1) AND
       (sdr.relating_shape_aspect.description = 'outside boundary'))) 
       = 1))) = 1))) = 0;
END_ENTITY;

ENTITY parallelism_tolerance
  SUBTYPE OF (geometric_tolerance_with_datum_reference);
WHERE
  WR1: SELF\geometric_tolerance.name = 'parallelism';
  WR2: SIZEOF (SELF\geometric_tolerance_with_datum_reference.datum_system) =  
       1;
END_ENTITY;

ENTITY partial_circular_profile
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN
       TYPEOF (SELF.of_shape.definition);
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 3))) = 0))) = 0;  
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND 
       (it.name = 'orientation'))) = 1))) = 0))) = 0;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'radius'))) = 1))) = 0))) = 0;
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'sweep angle'))) = 1))) 
       = 0))) = 0;
END_ENTITY;

ENTITY path_feature_component
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN
       TYPEOF (SELF.of_shape.definition);
  WR2: SELF.description IN ['partial circular', 'complete circular', 'linear', 
       'complex'];
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR4: (NOT (SELF.description = 'partial circular')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 3))) = 0))) = 0);
  WR5: (NOT (SELF.description = 'partial circular')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'radius'))) = 1))) = 0))) = 0);
  WR6: (NOT (SELF.description = 'partial circular')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'sweep angle'))) = 1))) = 0))) = 0);
  WR7: (NOT (SELF.description = 'complete circular')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 2))) = 0))) = 0);
  WR8: (NOT (SELF.description = 'complete circular')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'radius'))) = 1))) = 0))) = 0);
  WR9: (NOT (SELF.description = 'linear')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 2))) = 0))) = 0);
 WR10: (NOT (SELF.description = 'linear')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
          'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'distance'))) = 1))) = 0))) = 0);
 WR11: (NOT (SELF.description = 'linear')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.DIRECTION_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0);
 WR12: (NOT (SELF.description = 'complex')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 1))) = 0))) = 0);
 WR13: (NOT (SELF.description = 'complex')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.PATH_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation)) AND
       (pdr.used_representation.name = 'sweep path'))) = 1))) = 0);
 WR14: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND
       (it.name = 'orientation'))) = 1))) = 0))) = 0;
END_ENTITY;

ENTITY path_shape_representation
  SUBTYPE OF (representation);
WHERE
  WR1: SIZEOF (SELF.items) = 1;
  WR2: SIZEOF (QUERY (it <* SELF.items |
       NOT ('FEATURE_BASED_PROCESS_PLANNING.EDGE_LOOP' IN TYPEOF 
       (it)))) = 0;
  WR3: SIZEOF (QUERY (it <* SELF.items |
       NOT (SIZEOF (QUERY (el <* it\path.edge_list |
       NOT ('FEATURE_BASED_PROCESS_PLANNING.EDGE_CURVE' IN
       TYPEOF (el.edge_element)))) = 0)))  = 0;
END_ENTITY;

ENTITY pattern_offset_membership 
  SUBTYPE OF (feature_component_relationship);
WHERE
  WR1: SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN',
       'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN'] *
       TYPEOF (SELF.relating_shape_aspect)) = 1;  
  WR2: SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (SELF.related_shape_aspect,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' IN
       TYPEOF (sar)) AND (sar :<>: SELF)) |
       'FEATURE_BASED_PROCESS_PLANNING.MODIFIED_PATTERN' IN 
       TYPEOF (fcr.relating_shape_aspect))) >= 1; 
  WR3: SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (SELF.related_shape_aspect,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' IN
       TYPEOF (sar)) AND (sar :<>: SELF)) |
       ('FEATURE_BASED_PROCESS_PLANNING.MODIFIED_PATTERN' IN 
       TYPEOF (fcr.relating_shape_aspect)) AND 
       (NOT (SIZEOF (QUERY (modfcr <* QUERY (modsar <*
       USEDIN (fcr.relating_shape_aspect, 'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT') |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN',
       'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN'] *
       TYPEOF (modsar.related_shape_aspect)) = 1) AND 
       (modsar :<>: fcr)) |
       NOT (modfcr.related_shape_aspect :=: SELF.relating_shape_aspect))) 
       = 0)))) = 0; 
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF.related_shape_aspect,  
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION')) = 1))) = 0;
  WR5: (NOT ('FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN' IN 
       TYPEOF (SELF.relating_shape_aspect))) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF.related_shape_aspect, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       NOT (SIZEOF (pdr.used_representation.items) = 2))) = 0))) = 0);
  WR6: (NOT ('FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN' IN 
       TYPEOF (SELF.relating_shape_aspect))) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF.related_shape_aspect, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND 
       ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' IN 
       TYPEOF (it\measure_with_unit.value_component)) AND 
       (it.name = 'index number'))) = 1))) = 0))) = 0);
  WR7: (NOT ('FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN' IN 
       TYPEOF (SELF.relating_shape_aspect))) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF.related_shape_aspect, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT' IN 
       TYPEOF (it)) AND (it.name = 'offset'))) = 1))) = 0))) = 0);
  WR8: (NOT ('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN' IN 
       TYPEOF (SELF.relating_shape_aspect))) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF.related_shape_aspect, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       NOT (SIZEOF (pdr.used_representation.items) = 3))) = 0))) = 0);
  WR9: (NOT ('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN' IN 
       TYPEOF (SELF.relating_shape_aspect))) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF.related_shape_aspect, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND 
       ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' IN 
       TYPEOF (it\measure_with_unit.value_component)) AND 
       (it.name = 'row index'))) = 1))) = 0))) = 0);
 WR10: (NOT ('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN' IN 
       TYPEOF (SELF.relating_shape_aspect))) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF.related_shape_aspect, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND 
       ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' IN 
       TYPEOF (it\measure_with_unit.value_component)) AND 
       (it.name = 'column index'))) = 1))) = 0))) = 0);
 WR11: (NOT ('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN' IN 
       TYPEOF (SELF.relating_shape_aspect))) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF.related_shape_aspect, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT' IN 
       TYPEOF (it)) AND (it.name = 'offset distance'))) = 1))) = 0))) = 0);
 WR12: (NOT ('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN' IN 
       TYPEOF (SELF.relating_shape_aspect))) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF.related_shape_aspect,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.DIRECTION_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation)) AND 
       (pdr.used_representation.name = 'offset direction'))) = 1))) = 0);
END_ENTITY;

ENTITY pattern_omit_membership
  SUBTYPE OF (feature_component_relationship);
WHERE
  WR1: SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN',
       'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN'] *
       TYPEOF (SELF.relating_shape_aspect)) = 1;  
  WR2: SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (SELF.related_shape_aspect,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' IN
       TYPEOF (sar)) AND (sar :<>: SELF)) |
       'FEATURE_BASED_PROCESS_PLANNING.MODIFIED_PATTERN' IN 
       TYPEOF (fcr.relating_shape_aspect))) >= 1; 
  WR3: SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (SELF.related_shape_aspect,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' IN
       TYPEOF (sar)) AND (sar :<>: SELF)) |
       ('FEATURE_BASED_PROCESS_PLANNING.MODIFIED_PATTERN' IN 
       TYPEOF (fcr.relating_shape_aspect)) AND 
       (NOT (SIZEOF (QUERY (modfcr <* QUERY (modsar <*
       USEDIN (fcr.relating_shape_aspect, 'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT') |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN',
       'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN'] *
       TYPEOF (modsar.related_shape_aspect)) = 1) AND 
       (modsar :<>: fcr)) |
       NOT (modfcr.related_shape_aspect :=: SELF.relating_shape_aspect))) 
       = 0)))) = 0;
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF.related_shape_aspect,  
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION')) = 1))) = 0;
  WR5: (NOT ('FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN' IN 
       TYPEOF (SELF.relating_shape_aspect))) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF.related_shape_aspect, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       NOT (SIZEOF (pdr.used_representation.items) = 1))) = 0))) = 0);
  WR6: (NOT ('FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_PATTERN' IN 
       TYPEOF (SELF.relating_shape_aspect))) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF.related_shape_aspect, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND 
       ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' IN 
       TYPEOF (it\measure_with_unit.value_component)) AND 
       (it.name = 'index number'))) = 1))) = 0))) = 0);
  WR7: (NOT ('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN' IN 
       TYPEOF (SELF.relating_shape_aspect))) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF.related_shape_aspect, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       NOT (SIZEOF (pdr.used_representation.items) = 2))) = 0))) = 0);
  WR8: (NOT ('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN' IN 
       TYPEOF (SELF.relating_shape_aspect))) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF.related_shape_aspect, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND 
       ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' IN 
       TYPEOF (it\measure_with_unit.value_component)) AND 
       (it.name = 'row index'))) = 1))) = 0))) = 0);
  WR9: (NOT ('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_PATTERN' IN 
       TYPEOF (SELF.relating_shape_aspect))) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF.related_shape_aspect, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND 
       ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' IN 
       TYPEOF (it\measure_with_unit.value_component)) AND 
       (it.name = 'column index'))) = 1))) = 0))) = 0);
END_ENTITY;

ENTITY perpendicularity_tolerance
  SUBTYPE OF (geometric_tolerance_with_datum_reference);
WHERE
  WR1: SELF\geometric_tolerance.name = 'perpendicularity';
  WR2: SIZEOF (SELF\geometric_tolerance_with_datum_reference.datum_system)
       = 1;
END_ENTITY;

ENTITY placed_datum_target_feature
  SUBTYPE OF (datum_target);
WHERE 
  WR1: SELF.description IN ['point', 'line', 'rectangle', 'circle'];
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (dtm_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* dtm_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND
       (it.name = 'orientation'))) = 1))) = 0))) = 0;
  WR4: (NOT (SELF.description = 'point')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (dtm_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (dtm_rep.used_representation.items) = 1))) = 0)))  = 0);
  WR5: (NOT (SELF.description IN ['line', 'circle'])) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (dtm_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (dtm_rep.used_representation.items) = 2))) = 0)))  = 0); 
  WR6: (NOT (SELF.description = 'rectangle')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (dtm_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (dtm_rep.used_representation.items) = 3))) = 0))) = 0);
  WR7: (NOT (SELF.description = 'circle')) OR 
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (dtm_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* dtm_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND
       (it.name = 'target diameter'))) = 1))) = 0))) = 0);
  WR8: (NOT (SELF.description = 'line')) OR 
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (dtm_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* dtm_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'target length'))) = 1))) = 0))) = 0);
  WR9: (NOT (SELF.description = 'rectangle')) OR 
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (dtm_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* dtm_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'target length'))) = 1))) = 0))) = 0);
 WR10: (NOT (SELF.description = 'rectangle')) OR 
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (dtm_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* dtm_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'target width'))) = 1))) = 0))) = 0);
END_ENTITY;

ENTITY pocket
  SUBTYPE OF (feature_definition);
WHERE
  WR1: SELF.description IN ['closed rectangular', 'open rectangular', 
       'non-rectangular'];
  WR2: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'pocket depth occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'path feature component usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.PATH_FEATURE_COMPONENT' IN
       TYPEOF (sdr.relating_shape_aspect)) AND
       (sdr.name = 'pocket depth') AND
       (sdr.relating_shape_aspect.description = 'linear'))) = 1))) = 1))) = 0;
  WR3: (NOT (SELF.description = 'non-rectangular')) OR 
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'boundary occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_CLOSED_PROFILE', 
       'FEATURE_BASED_PROCESS_PLANNING.NGON_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.CLOSED_PATH_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.SQUARE_U_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.PARTIAL_CIRCULAR_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.ROUNDED_U_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.VEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.TEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.OPEN_PATH_PROFILE'] *
       TYPEOF (sdr.relating_shape_aspect)) = 1) AND
       (sdr.relating_shape_aspect.description = 'boundary'))) 
       = 1))) = 1))) = 0);
  WR4: (NOT (SELF.description = 'closed rectangular')) OR 
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'closed boundary occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_CLOSED_PROFILE' 
       IN TYPEOF (sdr.relating_shape_aspect)) AND
       (sdr.relating_shape_aspect.description = 'boundary'))) 
       = 1))) = 1))) = 0);
  WR5: (NOT (SELF.description = 'open rectangular')) OR 
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'open boundary occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.SQUARE_U_PROFILE' 
       IN TYPEOF (sdr.relating_shape_aspect)) AND
       (sdr.relating_shape_aspect.description = 'boundary'))) 
       = 1))) = 1))) = 0);
  WR6: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'bottom condition occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'pocket bottom usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'FEATURE_COMPONENT_RELATIONSHIP' IN TYPEOF (sar))) |
       'FEATURE_BASED_PROCESS_PLANNING.POCKET_BOTTOM' IN  
       TYPEOF (sdr.relating_shape_aspect))) = 1))) = 1))) = 0;
  WR7: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'change in boundary occurrence') AND
       (SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (sa_occ, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') |
       (sar.description = 'taper usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'FEATURE_COMPONENT_RELATIONSHIP' IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.TAPER' IN  
       TYPEOF (fcr.related_shape_aspect)) AND
       (fcr.related_shape_aspect.description = 'angle taper'))) 
       = 1))) <= 1))) = 0;
END_ENTITY;

ENTITY pocket_bottom
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN
       TYPEOF (SELF.of_shape.definition);
  WR2: SELF.description IN ['planar', 'non-planar', 'through'];
  WR3: (NOT (SELF.description = 'non-planar')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation))) = 1))) = 1);
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR5: (NOT (SELF.description IN  ['planar', 'non-planar'])) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 2))) = 0))) = 0); 
  WR6: (NOT (SELF.description = 'through')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 1))) = 0))) = 0); 
  WR7: (NOT (SELF.description IN ['planar', 'non-planar'])) OR 
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'radius'))) = 1))) = 0))) = 0);
  WR8: SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') | 
       (sar.description = 'pocket bottom usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' IN
       TYPEOF (sar))) |
       (fcr.related_shape_aspect.description = 'bottom condition occurrence') 
       AND
       ('FEATURE_BASED_PROCESS_PLANNING.POCKET' IN TYPEOF
       (fcr.related_shape_aspect.of_shape.definition)))) >= 1;
  WR9: ((NOT (SELF.description IN ['planar','non-planar'])) OR
       (SIZEOF(QUERY ( pd <* USEDIN(SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION')
       | (NOT (SIZEOF(QUERY ( impl_rep <* QUERY ( pdr <* USEDIN(pd,
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') | ((
       'FEATURE_BASED_PROCESS_PLANNING.' + 
       'SHAPE_REPRESENTATION_WITH_PARAMETERS') IN TYPEOF(pdr.
       used_representation)) ) | (NOT (SIZEOF(QUERY ( it <* 
       impl_rep.used_representation.items | 
       (('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM'
       IN TYPEOF(it)) AND (it.name = 'pocket bottom orientation') 
       AND (it.description IN ['pocket start','pocket end'])) )) = 
       1)) )) = 0)) )) = 0));
END_ENTITY;

ENTITY position_tolerance
  SUBTYPE OF (geometric_tolerance_with_datum_reference);
WHERE
  WR1: SELF\geometric_tolerance.name = 'position';
  WR2: SIZEOF (SELF\geometric_tolerance_with_datum_reference.datum_system) <=
       3;
END_ENTITY;

ENTITY protrusion
  SUBTYPE OF (feature_definition);
WHERE
  WR1: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'shape volume occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'volume shape usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar)))  |
       sdr.relating_shape_aspect.description = 'volume shape')) 
       = 1))) = 1))) = 0; 
END_ENTITY;

ENTITY rectangular_closed_profile
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN
       TYPEOF (SELF.of_shape.definition);
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') | 
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 4))) = 0))) = 0; 
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND 
       (it.name = 'orientation'))) = 1))) = 0))) = 0;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'width'))) = 1))) = 0))) = 0;
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'length'))) = 1))) = 0))) = 0;
  WR7: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'corner radius'))) = 1))) = 0))) = 0;
END_ENTITY;

ENTITY rectangular_pattern
  SUBTYPE OF (replicate_feature);
WHERE
  WR1: SIZEOF (USEDIN (SELF,'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT')) <= 5;
  WR2: SIZEOF (QUERY (sar <* USEDIN (SELF,'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_ASPECT_RELATIONSHIP.RELATING_SHAPE_ASPECT') |
       NOT (SIZEOF (
       ['FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP',
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP'] *  
       TYPEOF (sar)) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.DIRECTION_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation)) AND
       (pdr.used_representation.name = 'row layout direction'))) = 1))) = 0;
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation)) AND 
       (pdr.used_representation.name = 'column layout direction'))) 
       = 1))) = 0;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) | 
       NOT (SIZEOF (impl_rep.used_representation.items) = 5))) = 0))) = 0;
  WR7: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND 
       ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' IN 
       TYPEOF (it\measure_with_unit.value_component)) AND 
       (it.name = 'number of rows'))) = 1))) = 0))) = 0;
  WR8: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND 
       ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' IN 
       TYPEOF (it\measure_with_unit.value_component)) AND 
       (it.name = 'number of columns'))) = 1))) = 0))) = 0;
  WR9: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'row spacing'))) = 1))) = 0))) = 0;
 WR10: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'column spacing'))) = 1))) = 0)))
       = 0;
 WR11: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN 
       TYPEOF (it)) AND (it.name = 'orientation'))) = 1))) = 0))) = 0;
END_ENTITY;

ENTITY removal_volume
  SUBTYPE OF (feature_definition);
WHERE 
  WR1: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'shape volume occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'volume shape usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar)))  |
       sdr.relating_shape_aspect.description = 'volume shape')) 
       = 1))) = 1))) = 0; 
END_ENTITY;

ENTITY replicate_feature
  SUPERTYPE OF (ONEOF (circular_pattern, rectangular_pattern, 
    modified_pattern, feature_pattern))
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') |
       'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' IN
       TYPEOF (sar)) |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.REPLICATE_FEATURE',
       'FEATURE_BASED_PROCESS_PLANNING.MACHINING_FEATURE'] * 
       TYPEOF (fcr.related_shape_aspect)) = 1) AND
       (fcr.name = 'pattern basis'))) = 1;
END_ENTITY;

ENTITY revolved_profile
  SUBTYPE OF (feature_definition);
WHERE
  WR1: SELF.description IN ['groove', 'flat', 'round', 'open profile'];
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *
       TYPEOF (it)) = 2)  AND (it.name = 'radius'))) = 1))) = 0))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       ('FEATURE_BASED_PROCESS_PLANNING.DIRECTION_SHAPE_REPRESENTATION'
       IN TYPEOF (pdr.used_representation)) AND
       (pdr.used_representation.name = 'removal direction'))) = 1))) = 0;
  WR4: (NOT (SELF.description = 'open profile')) OR 
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'outer edge shape occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.OPEN_PATH_PROFILE' 
       IN TYPEOF (sdr.relating_shape_aspect)) AND
       (sdr.relating_shape_aspect.description = 'outer edge shape'))) 
       = 1))) = 1))) = 0);
  WR5: (NOT (SELF.description = 'flat')) OR 
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'flat edge shape occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.LINEAR_PROFILE' 
       IN TYPEOF (sdr.relating_shape_aspect)) AND
       (sdr.relating_shape_aspect.description = 'flat edge shape'))) 
       = 1))) = 1))) = 0);
  WR6: (NOT (SELF.description = 'round')) OR 
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'rounded edge shape occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.PARTIAL_CIRCULAR_PROFILE' 
       IN TYPEOF (sdr.relating_shape_aspect)) AND
       (sdr.relating_shape_aspect.description = 'rounded edge shape'))) 
       =1))) = 1))) = 0);
  WR7: (NOT (SELF.description = 'groove')) OR 
       (SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'sweep occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'sweep usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.SQUARE_U_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.PARTIAL_CIRCULAR_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.ROUNDED_U_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.VEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.TEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.OPEN_PATH_PROFILE'] *
       TYPEOF (sdr.relating_shape_aspect)) = 1) AND
       (sdr.relating_shape_aspect.description = 'sweep'))) = 1))) = 1))) = 0);
END_ENTITY;

ENTITY round_hole
  SUBTYPE OF (feature_definition);
WHERE
  WR1: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'diameter occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_CLOSED_PROFILE' IN
       TYPEOF (sdr.relating_shape_aspect)) AND
       (sdr.name = 'diameter'))) = 1))) = 1))) = 0;
  WR2: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'hole depth occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'path feature component usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.PATH_FEATURE_COMPONENT' IN
       TYPEOF (sdr.relating_shape_aspect)) AND
       (sdr.name = 'hole depth') AND
       (sdr.relating_shape_aspect.description = 'linear'))) = 1))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'bottom condition occurrence') AND
       (SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'hole bottom usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'FEATURE_COMPONENT_RELATIONSHIP' IN TYPEOF (sar))) |
       'FEATURE_BASED_PROCESS_PLANNING.HOLE_BOTTOM' IN  
       TYPEOF (fcr.relating_shape_aspect))) = 1))) = 1))) = 0;
  WR4: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'change in diameter occurrence') AND
       (SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'taper usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'FEATURE_COMPONENT_RELATIONSHIP' IN TYPEOF (sar))) |
       'FEATURE_BASED_PROCESS_PLANNING.TAPER' IN  
       TYPEOF (fcr.relating_shape_aspect))) = 1))) <= 1))) = 0; 
END_ENTITY;

ENTITY rounded_end
  SUBTYPE OF (feature_definition);
WHERE
  WR1: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'partial circular boundary occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.PARTIAL_CIRCULAR_PROFILE' IN
       TYPEOF (sdr.relating_shape_aspect)) AND
       (sdr.name = 'partial circular boundary'))) = 1))) = 1))) = 0; 
  WR2: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'course of travel occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'path feature component usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.PATH_FEATURE_COMPONENT' IN
       TYPEOF (sdr.relating_shape_aspect)) AND
       (sdr.relating_shape_aspect.description = 'linear'))) 
       = 1))) = 1))) = 0; 
END_ENTITY;

ENTITY rounded_u_profile
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN
       TYPEOF (SELF.of_shape.definition);
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 2))) = 0))) = 0;  
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND 
       (it.name = 'orientation'))) = 1))) = 0))) = 0;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'width'))) = 1))) = 0))) = 0;
END_ENTITY;

ENTITY shape_defining_relationship
  SUBTYPE OF (shape_aspect_relationship);
END_ENTITY;

ENTITY shape_representation_with_parameters
  SUBTYPE OF (shape_representation);
WHERE
  WR1: SIZEOF (QUERY (it <* SELF.items |
       NOT (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.PLACEMENT',
       'FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM'] *
       TYPEOF (it)) = 1))) = 0;
END_ENTITY;

ENTITY slot
  SUBTYPE OF (feature_definition);
WHERE
  WR1:SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 2))) = 0; 
  WR2:SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'depth'))) = 1))) = 0))) = 0;
  WR3: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'swept shape occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.SQUARE_U_PROFILE', 
       'FEATURE_BASED_PROCESS_PLANNING.PARTIAL_CIRCULAR_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.ROUNDED_U_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.VEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.TEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.OPEN_PATH_PROFILE'] *
       TYPEOF (sdr.relating_shape_aspect)) = 1) AND
       (sdr.relating_shape_aspect.description = 'swept shape'))) 
       = 1))) = 1))) = 0; 
  WR4: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'course of travel occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'path feature component usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       'FEATURE_BASED_PROCESS_PLANNING.PATH_FEATURE_COMPONENT' IN
       TYPEOF (sdr.relating_shape_aspect))) = 1))) = 1))) = 0; 
  WR5: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'end condition occurrence') AND
       (SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'slot end usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'FEATURE_COMPONENT_RELATIONSHIP' IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.SLOT_END' IN
       TYPEOF (fcr.relating_shape_aspect)) AND
       (fcr.relating_shape_aspect.description = 'end condition'))) 
       = 1))) = 2))) = 0;
END_ENTITY;

ENTITY slot_end
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN
       TYPEOF (SELF.of_shape.definition);
  WR2: SELF.description IN ['open', 'radiused', 'flat', 'woodruff'];
  WR3: (NOT (SELF.description IN ['open', 'radiused'])) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 0))) = 0);
  WR4: (NOT (SELF.description IN  ['flat', 'woodruff'])) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0);
  WR5: (NOT (SELF.description IN  ['flat'])) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 2))) = 0))) = 0);
  WR6: (NOT (SELF.description = 'flat')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'first radius'))) = 1))) = 0))) = 0);
  WR7: (NOT (SELF.description = 'flat')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'second radius'))) = 1))) = 0))) = 0);
  WR8: (NOT (SELF.description = 'woodruff')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT' IN 
       TYPEOF (it)) AND (it.name = 'radius'))) = 1))) = 0))) = 0);
  WR9: (NOT (SELF.description IN  ['woodruff'])) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 1))) = 0))) = 0);
 WR10: SIZEOF (QUERY (fcr <* QUERY (sar <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATING_SHAPE_ASPECT') | 
       (sar.description = 'slot end usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP' IN
       TYPEOF (sar))) |
       (fcr.related_shape_aspect.description = 'end condition occurrence') AND
       ('FEATURE_BASED_PROCESS_PLANNING.SLOT' IN TYPEOF
       (fcr.related_shape_aspect.of_shape.definition)))) >= 1;
END_ENTITY;

ENTITY spherical_cap
  SUBTYPE OF (feature_definition);
WHERE
  WR1: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'radius'))) = 1))) = 0))) = 0;
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'internal angle'))) = 1))) = 0))) = 0;
END_ENTITY;

ENTITY square_u_profile
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN
       TYPEOF (SELF.of_shape.definition);
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 6))) = 0))) = 0;  
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND 
       (it.name = 'orientation'))) = 1))) = 0))) = 0;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'width'))) = 1))) = 0))) = 0;
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'first radius'))) = 1))) = 0))) = 0;
  WR7: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'second radius'))) = 1))) = 0))) = 0;
  WR8: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'first angle'))) = 1))) = 0))) = 0;
  WR9: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'second angle'))) = 1))) = 0))) = 0;
END_ENTITY;

ENTITY step
  SUBTYPE OF (feature_definition);
WHERE
  WR1: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'course of travel occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'path feature component usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       ('FEATURE_BASED_PROCESS_PLANNING.PATH_FEATURE_COMPONENT' 
       IN TYPEOF (sdr.relating_shape_aspect)) AND
       (sdr.relating_shape_aspect.description = 'linear'))) = 1))) = 1))) = 0;
  WR2: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'removal boundary occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'profile usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       'FEATURE_BASED_PROCESS_PLANNING.VEE_PROFILE' 
       IN TYPEOF (sdr.relating_shape_aspect))) = 1))) = 1))) = 0;
END_ENTITY;

ENTITY surface_profile_tolerance
  SUBTYPE OF (geometric_tolerance);
WHERE
  WR1: SELF\geometric_tolerance.name = 'surface profile';
  WR2: (NOT ('FEATURE_BASED_PROCESS_PLANNING.' + 
       'GEOMETRIC_TOLERANCE_WITH_DATUM_REFERENCE' IN TYPEOF(SELF)))OR(SIZEOF 
       (SELF\geometric_tolerance_with_datum_reference.datum_system) <= 3);
END_ENTITY;

ENTITY symmetry_tolerance
  SUBTYPE OF (geometric_tolerance_with_datum_reference);
WHERE
  WR1: SELF\geometric_tolerance.name = 'symmetry';
  WR2: SIZEOF (SELF\geometric_tolerance_with_datum_reference.datum_system) <=
       3;
END_ENTITY;

ENTITY taper
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN
       TYPEOF (SELF.of_shape.definition);
  WR2: SELF.description IN ['angle taper', 'diameter taper'];
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |  NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 1))) = 0))) = 0; 
  WR5: (NOT (SELF.description = 'angle taper')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND
       (it.name = 'taper angle'))) = 1))) = 0))) = 0);
  WR6: (NOT (SELF.description = 'diameter taper')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND
       (it.name = 'taper diameter'))) = 1))) = 0))) = 0);
END_ENTITY;

ENTITY tee_profile
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN
       TYPEOF (SELF.of_shape.definition);
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 10))) = 0))) = 0; 
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND 
       (it.name = 'orientation'))) = 1))) = 0))) = 0;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'width'))) = 1))) = 0))) = 0;
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'depth'))) = 1))) = 0))) = 0;
  WR7: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'cross bar width'))) = 1))) = 0))) = 0;
  WR8: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'cross bar depth'))) = 1))) = 0))) = 0;
  WR9: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'first offset'))) = 1))) = 0))) = 0;
 WR10: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'second offset'))) = 1))) = 0))) = 0;
 WR11: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'first angle'))) = 1))) = 0))) = 0;
 WR12: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'second angle'))) = 1))) = 0))) = 0;
 WR13: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'radius'))) = 1))) = 0))) = 0;
END_ENTITY;

ENTITY thread
  SUBTYPE OF (feature_definition);
WHERE
  WR1: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'major diameter'))) = 1))) = 0))) = 0;
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'minor diameter'))) <= 1))) = 0))) 
       = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'pitch diameter'))) <= 1))) = 0))) 
       = 0;
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.RATIO_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'number of threads'))) = 1))) = 0))) 
       = 0;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND (it.name = 'fit class'))) <= 1))) = 0))) = 0;
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND (it.name = 'form'))) = 1))) = 0))) = 0;
  WR7: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND (it.name = 'hand'))) = 1))) = 0))) = 0;
  WR8: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND (it.name = 'qualifier'))) = 1))) = 0))) = 0;
  WR9: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND (it.name = 'thread system') AND
       ((it.description = 'english') OR
       (it.description = 'metric')))) = 1))) = 0))) = 0;
  WR10: SIZEOF (QUERY (pd <* USEDIN (SELF, 
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
        NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
        'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
        'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
        IN TYPEOF (pdr.used_representation)) |
        NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
        ('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' IN
        TYPEOF (it)) AND (it.name = 'thread side') AND
        ((it.description = 'internal') OR
        (it.description = 'external')))) = 1))) = 0))) = 0;
 WR11: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'partial area occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'applied area usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       'FEATURE_BASED_PROCESS_PLANNING.APPLIED_AREA' IN
       TYPEOF (sdr.relating_shape_aspect))) = 1))) <= 1))) = 0;
END_ENTITY;

ENTITY total_runout_tolerance
  SUBTYPE OF (geometric_tolerance_with_datum_reference);
WHERE
  WR1: SELF\geometric_tolerance.name = 'total runout';
  WR2: SIZEOF (SELF\geometric_tolerance_with_datum_reference.datum_system) <= 
       2;
END_ENTITY;

ENTITY transition_feature
  SUPERTYPE OF (ONEOF (chamfer, edge_round, fillet)) 
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION' IN 
       TYPEOF (SELF.of_shape.definition);
END_ENTITY;

ENTITY turned_knurl
  SUBTYPE OF (feature_definition);
WHERE
  WR1: SELF.description IN ['diamond', 'diagonal', 'straight'];
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND 
       ('FEATURE_BASED_PROCESS_PLANNING.COUNT_MEASURE' IN 
       TYPEOF (it\measure_with_unit.value_component)) AND 
       (it.name = 'number of teeth'))) <= 1))) = 0))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'major diameter'))) = 1))) = 0))) = 0;
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'nominal diameter'))) = 1))) = 0))) 
       = 0;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'tooth depth'))) <= 1))) = 0))) = 0;
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'root fillet'))) <= 1))) = 0))) = 0;
  WR7: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'diametral pitch'))) = 1))) = 0))) 
       = 0;
  WR8: (NOT (SELF.description IN ['diamond', 'diagonal'])) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] * 
       TYPEOF (it)) = 2) AND (it.name = 'helix angle'))) = 1))) = 0))) = 0);
  WR9: (NOT (SELF.description = 'diagonal')) OR
       (SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.DESCRIPTIVE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND (it.name = 'helix hand'))) = 1))) = 0))) = 0);
 WR10: SIZEOF (QUERY (pds <* QUERY (pd <* USEDIN (SELF,
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.PRODUCT_DEFINITION_SHAPE' IN
       TYPEOF (pd)) | 
       NOT (SIZEOF (QUERY (sa_occ <* USEDIN (pds,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT.OF_SHAPE') |
       (sa_occ.description = 'partial area occurrence') AND
       (SIZEOF (QUERY (sdr <* QUERY (sar <* USEDIN (sa_occ,
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_ASPECT_RELATIONSHIP.' +
       'RELATED_SHAPE_ASPECT') |
       (sar.description = 'applied area usage') AND
       ('FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_DEFINING_RELATIONSHIP' IN TYPEOF (sar))) |
       'FEATURE_BASED_PROCESS_PLANNING.APPLIED_AREA' IN  
       TYPEOF (sdr.relating_shape_aspect))) = 1))) <= 1))) = 0;
END_ENTITY;

ENTITY vee_profile
  SUBTYPE OF (shape_aspect);
WHERE
  WR1: 'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION' IN
       TYPEOF (SELF.of_shape.definition);
  WR2: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
       'DEFINITION') |
       NOT (SIZEOF (QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation))) = 1))) = 0;
  WR3: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (impl_rep.used_representation.items) = 4))) = 0))) = 0;
  WR4: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.PLACEMENT' IN TYPEOF (it)) AND 
       (it.name = 'orientation'))) = 1))) = 0))) = 0;
  WR5: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       ('FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM' IN
       TYPEOF (it)) AND 
       ('FEATURE_BASED_PROCESS_PLANNING.LENGTH_MEASURE_WITH_UNIT' IN 
       TYPEOF (it\measure_with_unit.value_component)) AND 
       (it.name = 'profile radius'))) = 1))) = 0))) = 0;
  WR6: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'profile angle'))) = 1))) = 0))) = 0;
  WR7: SIZEOF (QUERY (pd <* USEDIN (SELF, 
       'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.DEFINITION') |
       NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
       'FEATURE_BASED_PROCESS_PLANNING.' +
       'SHAPE_REPRESENTATION_WITH_PARAMETERS'
       IN TYPEOF (pdr.used_representation)) |
       NOT (SIZEOF (QUERY (it <* impl_rep.used_representation.items |
       (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.MEASURE_REPRESENTATION_ITEM',
       'FEATURE_BASED_PROCESS_PLANNING.PLANE_ANGLE_MEASURE_WITH_UNIT'] *    
       TYPEOF (it)) = 2) AND 
       (it.name = 'tilt angle'))) = 1))) = 0))) = 0;
END_ENTITY;

RULE application_context_requires_ap_definition FOR 
  (application_context, application_protocol_definition);
WHERE
  WR1: SIZEOF (QUERY (ac <* application_context | 
       NOT (SIZEOF (QUERY (apd <* application_protocol_definition | 
       (ac :=: apd.application) 
       AND
       (apd.application_interpreted_model_schema_name =   
       'feature_based_process_planning'))) = 1 ))) = 0;
END_RULE;

RULE approval_requires_approval_date_time FOR (approval,
  approval_date_time);
WHERE
  WR1: SIZEOF (QUERY (app <* approval |
       NOT (SIZEOF (QUERY (adt <* approval_date_time |
       app :=: adt.dated_approval )) = 1 ))) = 0;
END_RULE;

RULE approval_requires_approval_person_organization FOR 
  (approval, approval_person_organization);
WHERE
  WR1: SIZEOF (QUERY (app <* approval |
       NOT (SIZEOF (QUERY (apo <* approval_person_organization | 
       app :=: apo.authorized_approval )) >= 1 ))) = 0;
END_RULE;

RULE dependent_instantiable_action_request_status FOR (action_request_status);
WHERE
  WR1: SIZEOF (QUERY (arst <* action_request_status |
       NOT (SIZEOF (USEDIN (arst, '')) >= 1))) = 0;
END_RULE;

RULE dependent_instantiable_action_status FOR (action_status);
WHERE
  WR1: SIZEOF (QUERY (ast <* action_status |
       NOT (SIZEOF (USEDIN (ast, '')) >= 1))) = 0;
END_RULE;

RULE dependent_instantiable_approval_status FOR (approval_status);
WHERE
  WR1: SIZEOF (QUERY (ast <* approval_status |
       NOT (SIZEOF (USEDIN (ast, '')) >= 1))) = 0;
END_RULE;

RULE dependent_instantiable_date FOR (date);
WHERE
  WR1: SIZEOF (QUERY (dt <* date |
       NOT (SIZEOF (USEDIN (dt, '')) >= 1))) = 0;
END_RULE;

RULE dependent_instantiable_named_unit FOR (named_unit);
WHERE
  WR1: SIZEOF (QUERY (nu <* named_unit |
       NOT (SIZEOF (USEDIN (nu, '')) >= 1))) = 0;
END_RULE;

RULE dependent_instantiable_precision_qualifier FOR (precision_qualifier);
WHERE
  WR1: SIZEOF (QUERY (pq <* precision_qualifier |
       NOT (SIZEOF (USEDIN (pq, '')) >= 1))) = 0;
END_RULE;

RULE dependent_instantiable_type_qualifier FOR (type_qualifier);
WHERE
  WR1: SIZEOF (QUERY (tq <* type_qualifier |
       NOT (SIZEOF (USEDIN (tq, '')) >= 1))) = 0;
END_RULE;

RULE dependent_instantiable_uncertainty_qualifier FOR (uncertainty_qualifier);
WHERE
  WR1: SIZEOF (QUERY (uq <* uncertainty_qualifier |
       NOT (SIZEOF (USEDIN (uq, '')) >= 1))) = 0;
END_RULE;

RULE dependent_instantiable_security_classification_level FOR 
  (security_classification_level);
WHERE
  WR1: SIZEOF (QUERY (scl <* security_classification_level |
       NOT (SIZEOF (USEDIN (scl, '')) >= 1))) = 0;
END_RULE;

RULE dependent_instantiable_shape_representation FOR (shape_representation);
WHERE
  WR1: SIZEOF (QUERY (sr <* shape_representation |
       NOT (SIZEOF (USEDIN (sr, '')) >= 1))) = 0;
END_RULE;

RULE geometric_tolerance_subtype_exclusiveness FOR (geometric_tolerance);
WHERE
  WR1: SIZEOF (QUERY (gt <* geometric_tolerance |
       NOT (SIZEOF (TYPEOF (gt) *
       ['FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_RUNOUT_TOLERANCE', 
       'FEATURE_BASED_PROCESS_PLANNING.ANGULARITY_TOLERANCE',
       'FEATURE_BASED_PROCESS_PLANNING.CONCENTRICITY_TOLERANCE',
       'FEATURE_BASED_PROCESS_PLANNING.PARALLELISM_TOLERANCE', 
       'FEATURE_BASED_PROCESS_PLANNING.PERPENDICULARITY_TOLERANCE',
       'FEATURE_BASED_PROCESS_PLANNING.TOTAL_RUNOUT_TOLERANCE',
       'FEATURE_BASED_PROCESS_PLANNING.SURFACE_PROFILE_TOLERANCE', 
       'FEATURE_BASED_PROCESS_PLANNING.SYMMETRY_TOLERANCE',
       'FEATURE_BASED_PROCESS_PLANNING.POSITION_TOLERANCE',
       'FEATURE_BASED_PROCESS_PLANNING.LINEAR_PROFILE_TOLERANCE'])
       <= 2))) = 0;
END_RULE;

RULE machining_feature_life_cycle FOR    
 (machining_feature);
WHERE
  WR1: SIZEOF (QUERY (mf <* machining_feature |
       NOT (mf.of_shape.definition.frame_of_reference.life_cycle_stage =
       'manufacturing planning'))) = 0;
END_RULE;

RULE material_is_specified_for_part FOR (product_definition, 
  make_from_usage_option);
WHERE
  WR1: SIZEOF (QUERY (nmpd <* QUERY (pd <* product_definition |
       SIZEOF (USEDIN (pd, 'FEATURE_BASED_PROCESS_PLANNING.' + 
       'MATERIAL_DESIGNATION.DEFINITIONS')) = 0) |
       NOT (SIZEOF (QUERY (mfuo <* make_from_usage_option |
       NOT (nmpd :=: mfuo.relating_product_definition))) >= 1))) = 0;
END_RULE;

RULE part_requires_project_order FOR (product_definition_formation, 
  feature_based_pp_action_assignment);
WHERE
  WR1: SIZEOF (QUERY (pdf <* product_definition_formation |
       NOT (SIZEOF (QUERY (fbppaa <* feature_based_pp_action_assignment | 
       (pdf IN fbppaa.items) AND 
       (fbppaa.assigned_action.name = 'project order'))) = 1 ))) = 0;
END_RULE;

RULE part_to_approval FOR (product_definition_formation, 
  feature_based_pp_approval_assignment);
WHERE
  WR1: SIZEOF (QUERY (pdf <* product_definition_formation |
       NOT (SIZEOF (QUERY (fbppa <* feature_based_pp_approval_assignment | 
       pdf IN fbppa.items )) <= 1 ))) = 0;
END_RULE;

RULE product_requires_version FOR (product, product_definition_formation);
WHERE
  WR1: SIZEOF (QUERY (prod <* product |
       NOT (SIZEOF (QUERY (pdf <* product_definition_formation | 
       prod :=: pdf.of_product )) >= 1 ))) = 0;
END_RULE;

RULE product_definition_formation_requires_security_classification FOR
  (product_definition_formation,
  feature_based_pp_security_classification_assignment);
WHERE
  WR1: SIZEOF (QUERY (pdf <* product_definition_formation |
       NOT (SIZEOF (QUERY (fbppsca <* 
       feature_based_pp_security_classification_assignment | 
       pdf IN fbppsca.items )) = 1 ))) = 0;
END_RULE;

RULE project_order_requires_approval FOR 
  (directed_action, feature_based_pp_approval_assignment);
WHERE
  WR1: SIZEOF (QUERY (po <* QUERY (da <* directed_action | 
       da.name = 'project order') |
       NOT (SIZEOF (QUERY (fbppapp <* feature_based_pp_approval_assignment | 
       po IN fbppapp.items )) = 1 ))) = 0;
END_RULE;

RULE project_order_tracking_relationships FOR (directed_action,
  action_relationship);
WHERE
  WR1: SIZEOF (QUERY (da <* directed_action |
       (da.name IN ['shop work order', 'resource acquisition order',
       'digital technical data package work order',
       'pedigree creation order']) AND
       NOT (SIZEOF (QUERY (ar <* action_relationship |
       (da :=: ar.related_action) AND
       (('FEATURE_BASED_PROCESS_PLANNING.DIRECTED_ACTION' IN 
       TYPEOF (ar.relating_action)) AND
       (ar.relating_action.name = 'project order')))) = 1))) = 0;
  WR2: SIZEOF (QUERY (da <* directed_action |
       (da.name = 'project order') AND 
       NOT (SIZEOF (QUERY (ar <* action_relationship |
       (da :=: ar.relating_action) AND
       (('FEATURE_BASED_PROCESS_PLANNING.DIRECTED_ACTION' IN 
       TYPEOF (ar.related_action)) AND
       (ar.related_action.name  = 'shop work order')))) <= 1))) = 0; 
  WR3: SIZEOF (QUERY (da <* directed_action |
       (da.name = 'project order') AND 
       NOT (SIZEOF (QUERY (ar <* action_relationship |
       (da :=: ar.relating_action) AND
       (('FEATURE_BASED_PROCESS_PLANNING.DIRECTED_ACTION' IN 
       TYPEOF (ar.related_action)) AND
       (ar.related_action.name  = 'resource acquisition order')))) 
       <= 1))) = 0; 
  WR4: SIZEOF (QUERY (da <* directed_action |
       (da.name = 'project order') AND
       NOT (SIZEOF (QUERY (ar <* action_relationship |
       (da :=: ar.relating_action) AND
       (('FEATURE_BASED_PROCESS_PLANNING.DIRECTED_ACTION' IN 
       TYPEOF (ar.related_action)) AND
       (ar.related_action.name  = 
       'digital technical data package work order')))) <= 1))) = 0; 
  WR5: SIZEOF (QUERY (da <* directed_action |
       (da.name = 'project order') AND 
       NOT (SIZEOF (QUERY (ar <* action_relationship |
       (da :=: ar.relating_action) AND
       (('FEATURE_BASED_PROCESS_PLANNING.DIRECTED_ACTION' IN 
       TYPEOF (ar.related_action)) AND
       (ar.related_action.name  = 'pedigree creation order')))) 
       <= 1))) = 0; 
  WR6: SIZEOF (QUERY (da <* directed_action |
       (da.name = 'customer order') AND
       NOT (SIZEOF (QUERY (ar <* action_relationship |
       (da :=: ar.related_action) AND
       (('FEATURE_BASED_PROCESS_PLANNING.DIRECTED_ACTION' IN 
       TYPEOF (ar.relating_action)) AND
       (ar.relating_action.name = 'project order')))) >= 1))) = 0;
  WR7: SIZEOF (QUERY (da <* directed_action |
       (da.name = 'project order' ) AND 
       NOT (SIZEOF (QUERY (ar <* action_relationship |
       (da :=: ar.relating_action) AND
       (('FEATURE_BASED_PROCESS_PLANNING.DIRECTED_ACTION' IN 
       TYPEOF (ar.related_action)) AND
       (ar.related_action.name  = 'customer order')))) 
       <= 1))) = 0; 
END_RULE;

RULE representation_subtype_exclusiveness FOR (representation);
WHERE
  WR1: SIZEOF (QUERY (rep <* representation |
       NOT (SIZEOF (TYPEOF (rep) *
       ['FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION',
       'FEATURE_BASED_PROCESS_PLANNING.DEFINITIONAL_REPRESENTATION', 
       'FEATURE_BASED_PROCESS_PLANNING.DIRECTION_SHAPE_REPRESENTATION',
       'FEATURE_BASED_PROCESS_PLANNING.FACE_SHAPE_REPRESENTATION',
       'FEATURE_BASED_PROCESS_PLANNING.LOCATION_SHAPE_REPRESENTATION',
       'FEATURE_BASED_PROCESS_PLANNING.PATH_SHAPE_REPRESENTATION']) 
       <= 2))) = 0;
END_RULE;

RULE restrict_approval_status FOR (approval_status);
WHERE
  WR1: SIZEOF (QUERY (ast <* approval_status | 
       NOT (ast.name IN 
       ['approved', 'not yet approved', 'disapproved', 'withdrawn']))) = 0;
END_RULE;

RULE restrict_security_classification_level FOR
  (security_classification_level);
WHERE
  WR1: SIZEOF (QUERY (scl <* security_classification_level |
       NOT (scl.name IN 
       ['unclassified', 'classified', 'proprietary','confidential', 'secret',
       'top_secret']))) = 0;
END_RULE;

RULE shape_aspect_relationship_subtype_exclusiveness FOR 
  (shape_aspect_relationship);
WHERE
  WR1: SIZEOF (QUERY (sr <* shape_aspect_relationship |
       NOT (SIZEOF (TYPEOF (sr) *
       ['FEATURE_BASED_PROCESS_PLANNING.DIMENSIONAL_LOCATION',
       'FEATURE_BASED_PROCESS_PLANNING.GEOMETRIC_TOLERANCE_RELATIONSHIP',
       'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_RELATIONSHIP',
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_DEFINING_RELATIONSHIP'])
       <= 2))) = 0;
END_RULE;

RULE shape_aspect_subtype_exclusiveness FOR (shape_aspect);
WHERE
  WR1: SIZEOF (QUERY (sr <* shape_aspect |
       NOT (SIZEOF (TYPEOF (sr) *
       ['FEATURE_BASED_PROCESS_PLANNING.PATH_FEATURE_COMPONENT',
       'FEATURE_BASED_PROCESS_PLANNING.SLOT_END',
       'FEATURE_BASED_PROCESS_PLANNING.POCKET_BOTTOM',
       'FEATURE_BASED_PROCESS_PLANNING.BOSS_TOP',
       'FEATURE_BASED_PROCESS_PLANNING.HOLE_BOTTOM',
       'FEATURE_BASED_PROCESS_PLANNING.APPLIED_AREA',
       'FEATURE_BASED_PROCESS_PLANNING.TAPER',
       'FEATURE_BASED_PROCESS_PLANNING.CHAMFER_OFFSET',
       'FEATURE_BASED_PROCESS_PLANNING.CIRCULAR_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.NGON_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.CLOSED_PATH_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.SQUARE_U_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.LINEAR_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.TEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.VEE_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.RECTANGULAR_CLOSED_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.PARTIAL_CIRCULAR_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.ROUNDED_U_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.OPEN_PATH_PROFILE',
       'FEATURE_BASED_PROCESS_PLANNING.MACHINING_FEATURE',
       'FEATURE_BASED_PROCESS_PLANNING.REPLICATE_FEATURE',
       'FEATURE_BASED_PROCESS_PLANNING.TRANSITION_FEATURE',
       'FEATURE_BASED_PROCESS_PLANNING.DATUM',
       'FEATURE_BASED_PROCESS_PLANNING.DATUM_FEATURE',
       'FEATURE_BASED_PROCESS_PLANNING.DATUM_TARGET'])
       <= 2))) = 0;
END_RULE;

RULE shape_representation_subtype_exclusiveness FOR (shape_representation);
WHERE
  WR1: SIZEOF (QUERY (sr <* shape_representation |
       NOT (SIZEOF (TYPEOF (sr) *
       ['FEATURE_BASED_PROCESS_PLANNING.ADVANCED_BREP_SHAPE_REPRESENTATION', 
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_REPRESENTATION_WITH_PARAMETERS',
       'FEATURE_BASED_PROCESS_PLANNING.SHAPE_DIMENSION_REPRESENTATION']) 
       <= 2))) = 0;
END_RULE;

RULE subtype_mandatory_characterized_object FOR (characterized_object);
WHERE
  WR1: SIZEOF ( QUERY (csa <* characterized_object |
       NOT (SIZEOF (['FEATURE_BASED_PROCESS_PLANNING.FEATURE_DEFINITION', 
       'FEATURE_BASED_PROCESS_PLANNING.FEATURE_COMPONENT_DEFINITION',
       'FEATURE_BASED_PROCESS_PLANNING.ORDERED_PART']
       * TYPEOF(csa)) = 1))) = 0;
END_RULE;

RULE transition_feature_life_cycle FOR    
 (transition_feature);
WHERE
  WR1: SIZEOF (QUERY (tf <* transition_feature |
       NOT (tf.of_shape.definition.frame_of_reference.life_cycle_stage =
       'manufacturing planning'))) = 0;
END_RULE;

RULE transition_feature_on_part_boundary FOR    
 (transition_feature);
WHERE
  WR1: SIZEOF (QUERY (tf <* transition_feature |
       NOT (tf.product_definitional))) = 0;
END_RULE;

FUNCTION msb_shells (brep: manifold_solid_brep) : SET [1:?] OF  closed_shell;
 
     IF SIZEOF (QUERY (msbtype <* TYPEOF (brep) |
       msbtype LIKE '*BREP_WITH_VOIDS')) >= 1 THEN
       RETURN (brep\brep_with_voids.voids + brep.outer);
     ELSE
       RETURN([brep.outer]);
     END_IF;

END_FUNCTION;

FUNCTION number_of_representation_items (mf : machining_feature) : BOOLEAN;

  IF 'FEATURE_BASED_PROCESS_PLANNING.BOSS' IN TYPEOF (mf)
    THEN RETURN (SIZEOF (QUERY (pd <* USEDIN (mf, 
    'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
    'DEFINITION') |
    NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'SHAPE_REPRESENTATION_WITH_PARAMETERS'
    IN TYPEOF (pdr.used_representation)) | 
    NOT (SIZEOF (impl_rep.used_representation.items) = 2))) = 0))) = 0);
  END_IF;

  IF 'FEATURE_BASED_PROCESS_PLANNING.FLAT_FACE' IN TYPEOF (mf)
    THEN RETURN (SIZEOF (QUERY (pd <* USEDIN (mf, 
    'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
    'DEFINITION') |
    NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'SHAPE_REPRESENTATION_WITH_PARAMETERS'
    IN TYPEOF (pdr.used_representation)) | 
    NOT (SIZEOF (impl_rep.used_representation.items) = 1))) = 0))) = 0);
  END_IF;

  IF 'FEATURE_BASED_PROCESS_PLANNING.MARKING' IN TYPEOF (mf)
    THEN RETURN (SIZEOF (QUERY (pd <* USEDIN (mf, 
    'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
    'DEFINITION') |
    NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'SHAPE_REPRESENTATION_WITH_PARAMETERS'
    IN TYPEOF (pdr.used_representation)) | 
    NOT (SIZEOF (impl_rep.used_representation.items) = 6))) = 0))) = 0);
  END_IF;

  IF 'FEATURE_BASED_PROCESS_PLANNING.OUTER_ROUND' IN TYPEOF (mf)
    THEN 
    IF mf.description = 'outer diameter'
      THEN RETURN (SIZEOF (QUERY (pd <* USEDIN (mf, 
      'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
      'DEFINITION') |
      NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
      'FEATURE_BASED_PROCESS_PLANNING.' +
      'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
      'FEATURE_BASED_PROCESS_PLANNING.' +
      'SHAPE_REPRESENTATION_WITH_PARAMETERS'
      IN TYPEOF (pdr.used_representation)) | 
      NOT (SIZEOF (impl_rep.used_representation.items) = 3))) = 0))) = 0);
      ELSE
      IF mf.description = 'outer diameter to shoulder'
        THEN RETURN (SIZEOF (QUERY (pd <* USEDIN (mf, 
        'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
        'DEFINITION') |
        NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
        'FEATURE_BASED_PROCESS_PLANNING.' +
        'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
        'FEATURE_BASED_PROCESS_PLANNING.' +
        'SHAPE_REPRESENTATION_WITH_PARAMETERS'
        IN TYPEOF (pdr.used_representation)) | 
        NOT (SIZEOF (impl_rep.used_representation.items) = 2))) = 0))) = 0);
      END_IF;
    END_IF;
  END_IF;

  IF 'FEATURE_BASED_PROCESS_PLANNING.OUTSIDE_PROFILE' IN TYPEOF (mf)
    THEN RETURN (SIZEOF (QUERY (pd <* USEDIN (mf, 
    'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
    'DEFINITION') |
    NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'SHAPE_REPRESENTATION_WITH_PARAMETERS'
    IN TYPEOF (pdr.used_representation)) | 
    NOT (SIZEOF (impl_rep.used_representation.items) = 1))) = 0))) = 0);
  END_IF;

  IF 'FEATURE_BASED_PROCESS_PLANNING.POCKET' IN TYPEOF (mf)
    THEN RETURN (SIZEOF (QUERY (pd <* USEDIN (mf, 
    'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
    'DEFINITION') |
    NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'SHAPE_REPRESENTATION_WITH_PARAMETERS'
    IN TYPEOF (pdr.used_representation)) | 
    NOT (SIZEOF (impl_rep.used_representation.items) = 1))) = 0))) = 0);
  END_IF;

  IF 'FEATURE_BASED_PROCESS_PLANNING.PROTRUSION' IN TYPEOF (mf)
    THEN RETURN (SIZEOF (QUERY (pd <* USEDIN (mf, 
    'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
    'DEFINITION') |
    NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'SHAPE_REPRESENTATION_WITH_PARAMETERS'
    IN TYPEOF (pdr.used_representation)) | 
    NOT (SIZEOF (impl_rep.used_representation.items) = 1))) = 0))) = 0);
  END_IF;

  IF 'FEATURE_BASED_PROCESS_PLANNING.REMOVAL_VOLUME' IN TYPEOF (mf)
    THEN RETURN (SIZEOF (QUERY (pd <* USEDIN (mf, 
    'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
    'DEFINITION') |
    NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'SHAPE_REPRESENTATION_WITH_PARAMETERS'
    IN TYPEOF (pdr.used_representation)) | 
    NOT (SIZEOF (impl_rep.used_representation.items) = 1))) = 0))) = 0);
  END_IF;

  IF 'FEATURE_BASED_PROCESS_PLANNING.REVOLVED_PROFILE' IN TYPEOF (mf)
    THEN RETURN (SIZEOF (QUERY (pd <* USEDIN (mf, 
    'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
    'DEFINITION') |
    NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'SHAPE_REPRESENTATION_WITH_PARAMETERS'
    IN TYPEOF (pdr.used_representation)) | 
    NOT (SIZEOF (impl_rep.used_representation.items) = 2))) = 0))) = 0);
  END_IF;

  IF 'FEATURE_BASED_PROCESS_PLANNING.ROUND_HOLE' IN TYPEOF (mf)
    THEN RETURN (SIZEOF (QUERY (pd <* USEDIN (mf, 
    'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
    'DEFINITION') |
    NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'SHAPE_REPRESENTATION_WITH_PARAMETERS'
    IN TYPEOF (pdr.used_representation)) | 
    NOT (SIZEOF (impl_rep.used_representation.items) = 1))) = 0))) = 0);
  END_IF;

  IF 'FEATURE_BASED_PROCESS_PLANNING.ROUNDED_END' IN TYPEOF (mf)
    THEN RETURN (SIZEOF (QUERY (pd <* USEDIN (mf, 
    'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
    'DEFINITION') |
    NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'SHAPE_REPRESENTATION_WITH_PARAMETERS'
    IN TYPEOF (pdr.used_representation)) | 
    NOT (SIZEOF (impl_rep.used_representation.items) = 1))) = 0))) = 0);
  END_IF;

  IF 'FEATURE_BASED_PROCESS_PLANNING.SLOT' IN TYPEOF (mf)
    THEN RETURN (SIZEOF (QUERY (pd <* USEDIN (mf, 
    'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
    'DEFINITION') |
    NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'SHAPE_REPRESENTATION_WITH_PARAMETERS'
    IN TYPEOF (pdr.used_representation)) | 
    NOT (SIZEOF (impl_rep.used_representation.items) = 2))) = 0))) = 0);
  END_IF;

  IF 'FEATURE_BASED_PROCESS_PLANNING.SPHERICAL_CAP' IN TYPEOF (mf)
    THEN RETURN (SIZEOF (QUERY (pd <* USEDIN (mf, 
    'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
    'DEFINITION') |
    NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'SHAPE_REPRESENTATION_WITH_PARAMETERS'
    IN TYPEOF (pdr.used_representation)) | 
    NOT (SIZEOF (impl_rep.used_representation.items) = 3))) = 0))) = 0);
  END_IF;

  IF 'FEATURE_BASED_PROCESS_PLANNING.STEP' IN TYPEOF (mf)
    THEN RETURN (SIZEOF (QUERY (pd <* USEDIN (mf, 
    'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
    'DEFINITION') |
    NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'SHAPE_REPRESENTATION_WITH_PARAMETERS'
    IN TYPEOF (pdr.used_representation)) | 
    NOT (SIZEOF (impl_rep.used_representation.items) = 1))) = 0))) = 0);
  END_IF;

  IF 'FEATURE_BASED_PROCESS_PLANNING.THREAD' IN TYPEOF (mf)
    THEN RETURN (SIZEOF (QUERY (pd <* USEDIN (mf, 
    'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
    'DEFINITION') |
    NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'SHAPE_REPRESENTATION_WITH_PARAMETERS'
    IN TYPEOF (pdr.used_representation)) | 
    NOT ({8 <= SIZEOF (impl_rep.used_representation.items) <= 11}))) 
    = 0))) = 0);
  END_IF;

  IF 'FEATURE_BASED_PROCESS_PLANNING.TURNED_KNURL' IN TYPEOF (mf)
    THEN RETURN (SIZEOF (QUERY (pd <* USEDIN (mf, 
    'FEATURE_BASED_PROCESS_PLANNING.PROPERTY_DEFINITION.' +
    'DEFINITION') |
    NOT (SIZEOF (QUERY (impl_rep <* QUERY (pdr <* USEDIN (pd,
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'PROPERTY_DEFINITION_REPRESENTATION.DEFINITION') |
    'FEATURE_BASED_PROCESS_PLANNING.' +
    'SHAPE_REPRESENTATION_WITH_PARAMETERS'
    IN TYPEOF (pdr.used_representation)) | 
    NOT ({6 <= SIZEOF (impl_rep.used_representation.items) <= 9}))) 
    = 0))) = 0);
  END_IF;
  RETURN (TRUE);
END_FUNCTION;

END_SCHEMA;                     -- feature_based_process_planning
